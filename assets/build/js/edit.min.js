function pre_compile_templates(){for(var a=jQuery(".cf-editor-template"),b=0;b<a.length;b++)compiled_templates[a[b].id]=Handlebars.compile(a[b].innerHTML)}function get_compiled_template(a){return"object"!=typeof compiled_templates&&pre_compile_templates(),compiled_templates[a+"_tmpl"]?compiled_templates[a+"_tmpl"]:compiled_templates.noconfig_field_templ}function setup_field_type(a){return{id:a.trigger.prop("id")}}function check_required_bindings(a){var b,c=(jQuery(".caldera-header-save-button"),jQuery(".layout-form-field")),d=jQuery(".caldera-processor-nav"),e=!0;b=a?jQuery(a):jQuery(".caldera-config-field .required"),b.removeClass("has-error"),c.removeClass("has-error"),d.removeClass("has-error"),jQuery(".error-tag").remove(),required_errors={},b.each(function(a,b){var c=jQuery(b),d=c.closest(".caldera-config-editor-panel");if(b.value.length){if(c.hasClass("field-slug"))for(var f=jQuery(".field-slug").not(c),g=0;g<f.length;g++)if(f[g].value===b.value){var c=jQuery(f[g]);required_errors[d.prop("id")]||(required_errors[d.prop("id")]=0);var h=c.closest(".caldera-editor-field-config-wrapper"),i=c.closest(".caldera-editor-processor-config-wrapper");h.length&&jQuery('.layout-form-field[data-config="'+h.prop("id")+'"]').addClass("has-error"),i.length&&jQuery("."+i.prop("id")).addClass("has-error"),required_errors[d.prop("id")]+=1,c.addClass("has-error"),e=!1;break}if(c.hasClass("toggle_value_field"))for(var j=c.closest(".caldera-config-group").find(".toggle_value_field").not(c),g=0;g<j.length;g++)if(j[g].value===b.value){var c=jQuery(j[g]);required_errors[d.prop("id")]||(required_errors[d.prop("id")]=0);var h=c.closest(".caldera-editor-field-config-wrapper"),i=c.closest(".caldera-editor-processor-config-wrapper");h.length&&jQuery('.layout-form-field[data-config="'+h.prop("id")+'"]').addClass("has-error"),i.length&&jQuery("."+i.prop("id")).addClass("has-error"),required_errors[d.prop("id")]+=1,c.addClass("has-error"),e=!1;break}}else{required_errors[d.prop("id")]||(required_errors[d.prop("id")]=0);var h=c.closest(".caldera-editor-field-config-wrapper"),i=c.closest(".caldera-editor-processor-config-wrapper");h.length&&jQuery('.layout-form-field[data-config="'+h.prop("id")+'"]').addClass("has-error"),i.length&&jQuery("."+i.prop("id")).addClass("has-error"),required_errors[d.prop("id")]+=1,c.addClass("has-error"),e=!1}});for(var f in required_errors)jQuery(".caldera-forms-options-form").find('a[href="#'+f+'"]').append('<span class="error-tag">'+required_errors[f]+"</span>");return jQuery(".caldera-conditional-field-set").trigger("change"),e}function cf_revisions_ui(){var a=CF_ADMIN.rest.revisions,b=document.getElementById("tmpl--revisions");if(null!==b){var c=jQuery("#caldera-forms-revisions-spinner");c.css({visibility:"visible",float:"none"}),jQuery.get(a,function(a){if(a.hasOwnProperty("message"))document.getElementById("caldera-forms-revisions").innerHTML='<p class="notice notice-large notice-info">'+a.message+"</p>";else{var d={revisions:a};revisions=a;var e=b.innerHTML,f=jQuery("#tmpl--revisions").html();e=Handlebars.compile(f),document.getElementById("caldera-forms-revisions").innerHTML=e(d)}c.css({visibility:"hidden",float:"none"}),jQuery("input[type=radio][name=caldera-forms-revision]").change(function(){jQuery("#caldera-forms-revision-go").attr("href",jQuery(this).data("edit")).css({display:"inline-block",visibility:"visible"}).attr("aria-hidden",!1)})}).fail(function(){c.css({visibility:"hidden",float:"none"})})}}function new_conditional_group(a){var b=a.trigger.data("id"),c="cl"+Math.round(18746582734*Math.random());return{group:[{id:"rw"+Math.round(98347598345*Math.random()),type:a.trigger.data("type"),lines:[{id:c}]}],id:b}}function new_conditional_line(a){var b=a.trigger.data("id"),c=a.trigger.data("group"),d=a.trigger.data("type"),e="cl"+Math.round(18746582734*Math.random());return{id:b,type:d,lineid:e,rowid:c,name:"config["+d+"]["+b+"][conditions][group]["+c+"]["+e+"]"}}function build_conditions_config(a){var b=JSON.parse(a.trigger.val());return b.id=a.trigger.data("id"),b}function setup_field_type(a){return{id:a.trigger.prop("id")}}function check_required_bindings(a){var b,c=(jQuery(".caldera-header-save-button"),jQuery(".layout-form-field")),d=jQuery(".caldera-processor-nav"),e=!0;b=a?jQuery(a):jQuery(".caldera-config-field .required"),b.removeClass("has-error"),c.removeClass("has-error"),d.removeClass("has-error"),jQuery(".error-tag").remove(),required_errors={},b.each(function(a,b){var c=jQuery(b),d=c.closest(".caldera-config-editor-panel");if(b.value.length){if(c.hasClass("field-slug"))for(var f=jQuery(".field-slug").not(c),g=0;g<f.length;g++)if(f[g].value===b.value){var c=jQuery(f[g]);required_errors[d.prop("id")]||(required_errors[d.prop("id")]=0);var h=c.closest(".caldera-editor-field-config-wrapper"),i=c.closest(".caldera-editor-processor-config-wrapper");h.length&&jQuery('.layout-form-field[data-config="'+h.prop("id")+'"]').addClass("has-error"),i.length&&jQuery("."+i.prop("id")).addClass("has-error"),required_errors[d.prop("id")]+=1,c.addClass("has-error"),e=!1;break}if(c.hasClass("toggle_value_field"))for(var j=c.closest(".caldera-config-group").find(".toggle_value_field").not(c),g=0;g<j.length;g++)if(j[g].value===b.value){var c=jQuery(j[g]);required_errors[d.prop("id")]||(required_errors[d.prop("id")]=0);var h=c.closest(".caldera-editor-field-config-wrapper"),i=c.closest(".caldera-editor-processor-config-wrapper");h.length&&jQuery('.layout-form-field[data-config="'+h.prop("id")+'"]').addClass("has-error"),i.length&&jQuery("."+i.prop("id")).addClass("has-error"),required_errors[d.prop("id")]+=1,c.addClass("has-error"),e=!1;break}}else{required_errors[d.prop("id")]||(required_errors[d.prop("id")]=0);var h=c.closest(".caldera-editor-field-config-wrapper"),i=c.closest(".caldera-editor-processor-config-wrapper");h.length&&jQuery('.layout-form-field[data-config="'+h.prop("id")+'"]').addClass("has-error"),i.length&&jQuery("."+i.prop("id")).addClass("has-error"),required_errors[d.prop("id")]+=1,c.addClass("has-error"),e=!1}});for(var f in required_errors)jQuery(".caldera-forms-options-form").find('a[href="#'+f+'"]').append('<span class="error-tag">'+required_errors[f]+"</span>");return jQuery(".caldera-conditional-field-set").trigger("change"),e}var cfAdminAJAX;cfAdminAJAX="object"==typeof CF_ADMIN?CF_ADMIN.adminAjax:ajaxurl,jQuery(function(a){function b(a){var b=jQuery(a),d=b.val(),e=b.closest(".caldera-editor-field-config-wrapper"),f=e.find(".caldera-config-field-setup"),g=get_compiled_template(d),h=e.find(".field_config_string").val(),i=b.data("type");if(e.find(".caldera-config-group").show(),b.addClass("field-initialized"),h=h.length&&i===b.val()?JSON.parse(h):fieldtype_defaults[b.val()+"_cfg"],h||(h={}),h._id=b.data("field"),h._name="config[fields]["+b.data("field")+"][config]",g=jQuery("<div>").html(g(h)),f.html(g.html()),"function"==typeof window[b.val()+"_init"]&&window[b.val()+"_init"](b.data("field"),f),fieldtype_defaults[b.val()+"_nosupport"]&&(fieldtype_defaults[b.val()+"_nosupport"].indexOf("hide_label")>=0&&e.find(".hide-label-field").hide().find(".field-config").prop("checked",!1),fieldtype_defaults[b.val()+"_nosupport"].indexOf("caption")>=0&&e.find(".caption-field").hide().find(".field-config").val(""),fieldtype_defaults[b.val()+"_nosupport"].indexOf("required")>=0&&e.find(".required-field").hide().find(".field-config").prop("checked",!1),fieldtype_defaults[b.val()+"_nosupport"].indexOf("custom_class")>=0&&e.find(".customclass-field").hide().find(".field-config").val(""),fieldtype_defaults[b.val()+"_nosupport"].indexOf("entry_list")>=0&&e.find(".entrylist-field").hide().find(".field-config").prop("checked",!1)),e.find(".toggle_show_values").trigger("change"),!jQuery(".caldera-select-field-type").not(".field-initialized").length){if(core_form||(core_form=jQuery(".caldera-forms-options-form")),core_form.hasClass("builder-loaded"))c(b.data("field"));else{for(var j=jQuery(".caldera-select-field-type.field-initialized"),k=0;k<j.length;k++)c(jQuery(j[k]).data("field"));core_form.addClass("builder-loaded")}jQuery(".caldera-header-save-button").prop("disabled",!1),rebuild_field_binding(),baldrickTriggers()}if(jQuery(".color-field").length&&jQuery(".color-field").wpColorPicker({change:function(a){var b=jQuery(this);b.data("ev")&&clearTimeout(b.data("ev")),b.data("ev",setTimeout(function(){b.trigger("record")},200)),b.data("target")&&(jQuery(b.data("target")).css(b.data("style"),b.val()),jQuery(b.data("target")).val(b.val()))}}),["html","section_break"].indexOf(b.val())>=0){var l=e.find(".field-label");l.val()||l.val(b.val()+"__"+e.find(".field-id").val()).trigger("change")}}function c(a){var b=jQuery("#"+a),c=b.find(".caldera-select-field-type"),d=c.val(),e=jQuery('.layout-form-field[data-config="'+a+'"]'),f=e.find(".field_preview"),g=(jQuery("#preview-"+d+"_tmpl").html(),get_compiled_template("preview-"+d)),h={id:a},i=b.find(".field-config");i.each(function(b,c){for(var d=jQuery(c),e=d.prop("name").split("["+a+"]")[1].substr(1),f=e.substr(0,e.length-1).split("]["),g=d.is(":checkbox,:radio")?d.filter(":checked").val():d.val(),i={},j=f.length-1;j>=0;j--)if(j===f.length-1)i[f[j]]=g;else{var k=i;i={},i[f[j]]=k}jQuery.extend(!0,h,i)}),f.html(g(h)),e.removeClass("button"),jQuery(".preview-field-config").prop("disabled",!0)}function d(a){var b,c=jQuery(".caldera-editor-fields-panel"),d=(jQuery(".caldera-editor-groups-panel"),jQuery(".caldera-group-nav")),e=jQuery('[data-group="'+a+'"]'),f=e.find(".caldera-config-group-name"),g=e.find(".caldera-config-group-slug"),h=e.find(".caldera-config-group-desc"),i=e.find(".caldera-config-group-admin"),j=jQuery(".active-group-name"),k=jQuery(".active-group-slug"),l=jQuery(".active-group-desc"),m=jQuery(".active-group-admin"),n=jQuery(".caldera-editor-fields-list ul"),o=e.find(".caldera-config-group-repeat"),p=jQuery(".repeat-config-button"),q=(jQuery(".caldera-editor-group-settings"),jQuery(".caldera-config-group-remove"));jQuery(".new-group-input").remove(),jQuery(".new-field-input").remove(),d.removeClass("active"),c.show(),n.hide(),n.removeClass("active").find("li.active").removeClass("active"),n.hide(),e.addClass("active"),b=jQuery(".caldera-editor-fields-list ul.active li"),b.length?q.hide():q.show(),jQuery(".caldera-editor-field-config-wrapper").hide(),e.show(),j.val(f.val()),k.val(g.val()),l.val(h.val()),"1"===i.val()?m.prop("checked",!0):m.prop("checked",!1),"1"===o.val()?p.addClass("field-edit-open"):p.removeClass("field-edit-open")}var e=jQuery("#save_indicator");jQuery("#caldera-forms-restore-revision").on("click",function(a){a.preventDefault();var b=jQuery(this);e.addClass("loading"),jQuery.post({url:"admin.php?page=caldera-forms",data:{cf_edit_nonce:jQuery("#cf_edit_nonce").val(),form:b.data("form"),cf_revision:jQuery("#form_db_id_field").val(),restore:!0},success:function(){window.location=b.data("edit-link")}})}),jQuery("body").on("click",".toggle_processor_event input",function(a){var b=jQuery(this),c=b.closest(".wrapper-instance-pane"),d=c.find(".caldera-config-processor-setup"),e=c.find(".caldera-config-processor-notice"),f=b.is(":checked");f?(b.parent().addClass("activated"),b.parent().find(".is_active").show().attr("aria-hidden",!1).css("visibility","visible"),b.parent().find(".not_active").hide().attr("aria-hidden",!0).css("visibility","hidden"),jQuery(document).trigger("processor.enabled",{processorId:b.parent().data("pid")})):(b.parent().removeClass("activated"),b.parent().find(".is_active").hide().attr("aria-hidden",!0).css("visibility","hidden"),b.parent().find(".not_active").show().attr("aria-hidden",!1).css("visibility","visible"),jQuery(document).trigger("processor.disabled",{processorId:b.parent().data("pid")})),f?(d.slideDown(100),e.slideUp(100)):(d.slideUp(100),e.slideDown(100))}),jQuery("body").on("click",".toggle_option_tab > a",function(a){a.preventDefault();var b=jQuery(this),c=jQuery(b.attr("href")),d=b.parent().find("a"),e=b.closest(".caldera-editor-config-wrapper").find(".wrapper-instance-pane");d.removeClass("button-primary"),e.hide(),c.show(),b.addClass("button-primary")}),jQuery(".caldera-editor-body").on("change",".caldera-select-field-type",function(a){b(this)}),jQuery(".caldera-editor-body").on("click",".caldera-group-nav a",function(a){a.preventDefault(),d(jQuery(this).attr("href").substr(1))}),jQuery(".caldera-editor-body").on("click",".caldera-editor-fields-list a",function(a){a.preventDefault();var b=jQuery(this),c=jQuery(b.attr("href"));jQuery(".new-group-input").remove(),jQuery(".new-field-input").remove(),jQuery(".caldera-editor-fields-list li.active").removeClass("active"),b.parent().addClass("active"),jQuery(".caldera-editor-field-config-wrapper").hide(),c.show()}),jQuery(".caldera-editor-body").on("click",".group-config-button",function(a){var b=jQuery(this),c=jQuery(".caldera-editor-group-settings"),d=b.closest(".caldera-editor-fields-panel"),e=jQuery(".caldera-config-group-remove");d.find(".caldera-field-line").length?e.hide():e.show(),b.hasClass("field-edit-open")?(c.slideUp(100),b.removeClass("field-edit-open")):(c.slideDown(100),b.addClass("field-edit-open"))}),jQuery(".caldera-editor-body").on("keydown",".field-config",function(a){jQuery(this).is("textarea")||13===a.which&&a.preventDefault()}),jQuery(".caldera-editor-body").on("change",".field-label",function(a){var b=jQuery(this).closest(".caldera-editor-field-config-wrapper").prop("id"),c=jQuery('[data-field="'+b+'"]'),d=jQuery("#"+b+" .caldera-editor-field-title, .layout-form-field.field-edit-open .layout_field_name"),e=jQuery("#"+b+" .field-slug");c.find("a").html('<i class="icn-field"></i> '+this.value),d.text(this.value),"change"===a.type&&e.trigger("change"),rebuild_field_binding()}),jQuery(".caldera-editor-body").on("change",".active-group-name",function(a){a.preventDefault();var b=jQuery(".caldera-group-nav.active"),c=(b.data("group"),b.find(".caldera-config-group-name")),d=b.find("span");"focusout"!==a.type||this.value.length||(this.value="Group "+(parseInt(b.index())+1)),c.val(this.value),d.text(this.value)}),jQuery(".caldera-editor-body").on("change",".active-group-slug",function(a){a.preventDefault();var b=jQuery(".caldera-group-nav.active"),c=(b.data("group"),b.find(".caldera-config-group-name").val()),d=b.find(".caldera-config-group-slug"),e=(b.find("span"),this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase());"focusout"!==a.type||this.value.length||(e=c.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase()),d.val(e),this.value=e}),jQuery(".caldera-editor-body").on("change",".active-group-desc",function(a){a.preventDefault();var b=jQuery(".caldera-group-nav.active");b.data("group");b.find(".caldera-config-group-desc").val(this.value)}),jQuery(".caldera-editor-body").on("change",".active-group-admin",function(a){a.preventDefault();var b=jQuery(".caldera-group-nav.active"),c=(b.data("group"),b.find(".caldera-config-group-name").val(),b.find(".caldera-config-group-admin"));b.find("span"),this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase();jQuery(this).prop("checked")?(c.val(1),b.addClass("is-admin")):(c.val(0),b.removeClass("is-admin"))}),jQuery(".caldera-editor-body").on("click",".repeat-config-button",function(a){a.preventDefault();var b=jQuery(".caldera-group-nav.active"),c=(b.data("group"),b.find("a .group-type")),d=b.find(".caldera-config-group-repeat"),e=jQuery(this);e.hasClass("field-edit-open")?(d.val("0"),c.removeClass("icn-repeat").addClass("icn-folder"),e.removeClass("field-edit-open")):(d.val("1"),c.addClass("icn-repeat").removeClass("icn-folder"),e.addClass("field-edit-open"))}),jQuery(".caldera-editor-body").on("click",".delete-field",function(){var a=jQuery(this),b=a.closest(".caldera-editor-field-config-wrapper").prop("id");confirm(a.data("confirm"))&&(jQuery("#"+b).remove(),jQuery('option[value="'+b+'"]').remove(),jQuery('[data-bind="'+b+'"]').remove(),delete current_form_fields[b],jQuery('[data-config="'+b+'"]').slideUp(200,function(){jQuery(this).remove(),rebuild_field_binding(),jQuery(document).trigger("field.removed",{fieldId:b})}))}),jQuery(".caldera-editor-body").on("click",".add-new-group,.add-field",function(){var a=jQuery(this);if(jQuery(".new-group-input").remove(),jQuery(".new-field-input").remove(),a.hasClass("add-field")){jQuery('<input type="text" class="new-field-input block-input">').appendTo(jQuery(".caldera-editor-fields-list ul.active")).focus()}else{jQuery('<input type="text" class="new-group-input block-input">').appendTo(jQuery(".caldera-editor-groups-panel")).focus()}}),jQuery(".caldera-editor-body").on("change keypress",".new-group-input",function(a){if("keypress"===a.type){if(13!==a.which)return;a.preventDefault()}var b,c,e=this.value,f=jQuery(this),g=jQuery(".caldera-editor-groups-panel ul"),h=jQuery(".caldera-editor-fields-list");if(e.length){b=Handlebars.compile(jQuery("#caldera_group_line_templ").html()),c={id:e.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),name:e},g.append(b(c));jQuery('<ul data-group="'+c.id+'">').hide().appendTo(h),f.remove(),d(c.id)}else f.remove()}),jQuery(".caldera-editor-body").on("change keypress",".new-field-input",function(a){if("keypress"===a.type){if(13!==a.which)return;a.preventDefault()}var b,c,d,e=this.value,f=jQuery(this),g=f.parent(),h=jQuery(".caldera-editor-field-config"),i=jQuery(".caldera-config-group-remove");if(e.length){i.hide(),b=Handlebars.compile(jQuery("#caldera_field_line_templ").html()),c=Handlebars.compile(jQuery("#caldera_field_config_wrapper_templ").html()),d={id:e.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),label:e,slug:e.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),group:jQuery(".caldera-group-nav.active").data("group")};var j=jQuery(b(d));j.appendTo(g),h.append(c(d)),j.find("a").trigger("click"),f.remove()}else f.remove()}),jQuery(".caldera-editor-body").on("change",".field-slug",function(a){this.value.length?this.value=this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase():"change"===a.type&&(this.value=jQuery(this).closest(".caldera-editor-field-config-wrapper").find(".field-label").val().split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase())}),jQuery(".caldera-editor-body").on("click",".caldera-add-group",function(a){var b=jQuery(this),c=b.data("group"),d=jQuery("#"+c+"_panel_tmpl").html();b.parent().parent().append(d)}),jQuery(".caldera-editor-body").on("click",".caldera-config-group-remove",function(a){var b=jQuery(".active-group-slug").val();jQuery('[data-group="'+b+'"]').hide(0,function(){jQuery(this).remove();var a=jQuery(".caldera-group-nav");a.length?a.first().find("a").trigger("click"):jQuery(".caldera-editor-fields-panel").hide()})}),jQuery("body").on("click",".set-current-field",function(a){a.preventDefault();var b=jQuery(this);jQuery("#"+b.data("field")+"_type").val(b.data("type")).trigger("change"),jQuery("#"+b.data("field")+"_lable").focus(),jQuery("#field_setup_baldrickModalCloser").trigger("click")}),jQuery(".caldera-editor-body").on("change record",".field-config",function(a){void 0!==a.target.name&&void 0!==a.target.value&&jQuery(document).trigger("field.config-change",{name:a.target.name,value:a.target.value});var b=jQuery(this),d=b.closest(".caldera-editor-field-config-wrapper");current_form_fields&&(b.prop("id")===d.prop("id")+"_lable"&&(current_form_fields[d.prop("id")].label=this.value),b.prop("id")===d.prop("id")+"_slug"&&(current_form_fields[d.prop("id")].slug=this.value),b.prop("id")===d.prop("id")+"_type"&&(current_form_fields[d.prop("id")].type=this.value),d.length&&c(d.prop("id")))}),jQuery(".caldera-editor-body").on("focus",".caldera-field-bind",function(a){var b=jQuery(this),c=this.value;if(a.type&&"focusin"===a.type)return b.removeClass("bound_field").addClass("reload-binding"),rebind_field_bindings(),void(this.value=c)}),jQuery(".caldera-group-nav").first().find("a").trigger("click"),jQuery(".caldera-editor-body").on("change",".toggle_show_values",function(a){var b=jQuery(this),c=b.closest(".caldera-config-group-toggle-options"),d=c.find(".toggle_label_field"),e=c.find(".toggle_value_field, .toggle_calc_value_field"),f=c.find(".option-setting-label-for-value"),g=c.find(".option-setting-label-for-label"),h=(c.find(".option-group-control"),{width:"100%",display:"inline",float:"left"});b.prop("checked")?(e.show().css(h).attr("aria-hidden",!1),d.show().css(h).attr("aria-hidden",!1),f.show().css({display:"inline-block"}),g.css("display","inline")):(e.hide().attr("aria-hidden",!0),f.hide().attr("aria-hidden",!0),d.css("width",245),g.css("display","inline")),d.trigger("toggle.values"),init_magic_tags()}),jQuery(".caldera-editor-body").on("change",".auto-populate-type",function(){jQuery(this).closest(".wrapper-instance-pane").find(".auto-populate-options").trigger("change")}),jQuery(".caldera-editor-body").on("change",".auto-populate-options",function(){var a=jQuery(this),b=a.closest(".wrapper-instance-pane"),c=b.find(".caldera-config-group-toggle-options"),d=b.find(".caldera-config-group-auto-options"),e=d.find(".auto-populate-type");d.find(".auto-populate-type-panel").hide(),a.prop("checked")?(c.hide(),d.show()):(c.show(),d.hide()),d.find(".caldera-config-group-auto-"+e.val()).show()}),jQuery("body").on("change",".pin-toggle-roles",function(){var a=jQuery(this),b=jQuery("#caldera-pin-rules");"1"===a.val()?b.show():b.hide()}),jQuery("body").on("click",".magic-tag-init",function(a){jQuery(this).prev().focus().trigger("init.magic")}),jQuery("body").on("keyup  focus select click init.magic",".magic-tag-enabled",function(a){init_magic_tags();var b=jQuery(this),c=b.parent(),d=c.closest(".wrapper-instance-pane").find(".caldera-select-field-type").val()?c.closest(".wrapper-instance-pane").find(".caldera-select-field-type").val():"hidden",e=c.find(".magic-tags-autocomplete"),f=e.find("ul"),g=this.value,h=[],i="",j=this.selectionStart,k=this.selectionEnd;if(e.length&&e.data("focus"))return void a.preventDefault();if(b.data("tag",""),this.selectionEnd>this.selectionStart)i=this.value.substr(this.selectionStart,this.selectionEnd-this.selectionStart);else if(("select"===a.type||"keyup"===a.type)&&40!==a.which&&38!==a.which&&39!==a.which&&37!==a.which){for(j=this.selectionStart;j>0;j--){var l=g.substr(j-1,1);if(" "===l||"\n"===l||("%"===l||"}"===l)&&this.selectionStart===j)break}for(k=this.selectionStart;k<g.length;k++){var l=g.substr(k,1);if(" "===l||"\n"===l||("%"===l||"{"===l)&&this.selectionStart===k)break}i=g.substr(j,k-j)}if("focusout"!==a.type){"init"!==a.type&&i.length<3&&e.length&&e.remove(),e.length||(e=jQuery('<div class="magic-tags-autocomplete"></div>'),f=jQuery("<ul></ul>"),f.appendTo(e),e.insertAfter(b),e.on("mouseenter",function(){jQuery(this).data("focus",!0)}),e.on("mouseleave",function(){jQuery(this).data("focus",!1),setTimeout(function(){e.remove()},200),b.is(":focus")||b.trigger("focusout")})),f.empty();var m="system",n=!1;"hidden"===d||"dropdown"===d||"radio"===d||"toggle_switch"===d||"checkbox"===d?(n=!0,d="text",m="all"):"paragraph"!==d&&"html"!==d||(d="text"),b.data("type")&&(d=b.data("type")),d=d.split(","),d.push("vars");for(var o=0;o<d.length;o++)for(var p in system_values)if(system_values[p]&&void 0!==system_values[p].tags&&void 0!==system_values[p].tags[d[o]]){if(h=[p],"system"!==p&&"variable"!==p&&"field"!==p){var q=jQuery(".processor-"+p),r=b.closest(".caldera-editor-processor-config-wrapper"),s=r.prop("id");h=[];for(var t=0;t<q.length;t++)if(r.length||!0!==n){if(s===q[t].id)continue;jQuery("li."+q[t].id).index()<jQuery("li."+s).index()&&h.push(q[t].id)}else h.push(q[t].id)}for(var u=0;u<h.length;u++)if("all"===m||m===p||"variable"===p){var v=jQuery('<li class="header">'+system_values[p].type+(u>0?" ["+(u+1)+"]":"")+"</li>"),w=0;v.appendTo(f);for(var x=0;x<system_values[p].tags[d[o]].length;x++)if(!b.data("parent")||"variable:"+b.data("parent")!==system_values[p].tags[d[o]][x]){var y=system_values[p].wrap[0]+system_values[p].tags[d[o]][x]+system_values[p].wrap[1];if(h[u]!==p&&h.length>1&&(y=system_values[p].wrap[0]+system_values[p].tags[d[o]][x]+":"+h[u]+system_values[p].wrap[1]),y.indexOf(i)>=0||"init"===a.type){w+=1;var z=y.replace(i,"<strong>"+i+"</strong>"),A=jQuery('<li class="tag" data-tag="'+y+'">'+z+"</li>");A.on("click",function(){var a=jQuery(this).data("tag");b.val(g.substr(0,j)+a+g.substr(k)).trigger("change").focus(),b[0].selectionStart=j+a.length-(a.indexOf("*")>0?2:0),b[0].selectionEnd=j+a.length-(a.indexOf("*")>0?1:0),k=j=b[0].selectionEnd,g+=a,b.trigger("init.magic")}),A.appendTo(f)}}0===w&&v.remove()}}}f.children().length||e.remove(),"focusout"===a.type&&setTimeout(function(){e.remove()},200)}),pre_compile_templates(),jQuery(".caldera-select-field-type").not(".field-initialized").each(function(a,c){b(c)})});var rebuild_field_binding,rebind_field_bindings,current_form_fields={},required_errors={},add_new_grid_page,add_page_grid,init_magic_tags,core_form,compiled_templates={};init_magic_tags=function(){jQuery(".magic-tag-enabled").each(function(a,b){var c=jQuery(b);if(c.hasClass("magic-tag-init-bound")){var d=c.parent().find(".magic-tag-init");return void(c.is(":visible")?d.show():d.hide())}var e=jQuery('<span class=""></span>'),f=jQuery('<span style="position:relative;display:inline-block; width:100%;"></span>');c.is("input")&&e.css("borderBottom","none"),c.hasClass("caldera-conditional-value-field")&&f.width("auto"),c.wrap(f),e.insertAfter(c),c.addClass("magic-tag-init-bound"),c.is(":visible")?e.show():e.hide()})},rebuild_field_binding=function(){if(core_form||(core_form=jQuery(".caldera-forms-options-form")),core_form.hasClass("builder-loaded")){var a=jQuery(".caldera-editor-field-config-wrapper");system_values.field={tags:{text:[]},type:"Fields",wrap:["%","%"]};for(var b=0;b<a.length;b++){var c=a[b].id,d=jQuery("#"+c+"_lable").val(),e=jQuery("#"+c+"_slug").val(),f=jQuery("#"+c+"_type").val();void 0===system_values.field.tags[f]&&(system_values.field.tags[f]=[]),system_values.field.tags[f].push(e),"text"!==f&&system_values.field.tags.text.push(e),current_form_fields[c]={label:d,slug:e,type:f},jQuery("option.bound-field").trigger("change").each(function(a,b){var c=jQuery(b);0!==c.prop("value").indexOf("{")?c.text(jQuery("#"+c.prop("value")+"_lable").val()+" ["+jQuery("#"+c.prop("value")+"_lable").val()+"]"):c.text(c.prop("value").replace("{","").replace("}",""))}).removeClass("bound-field")}}},rebind_field_bindings=function(){var a,b,c=jQuery(".caldera-field-bind").not(".bound_field");if(c.length){c.addClass("bound_field");for(var d=0;d<c.length;d++){var e=jQuery(c[d]),f=e.val(),g=e.data("default"),h=e.data("exclude"),i=0,j=e.closest(".caldera-editor-processor-config-wrapper"),k=j.prop("id"),l="";if(g&&!e.hasClass("reload-binding")&&(f=g),e.is("select")){e.empty();var m=jQuery('<optgroup label="Fields">');for(var n in current_form_fields)e.data("type")&&e.data("type").split(",").indexOf(current_form_fields[n].type)<0||(e.data("id")!==n&&m.append('<option value="'+n+'"'+(f===n?'selected="selected"':"")+">"+current_form_fields[n].label+" ["+current_form_fields[n].slug+"]</option>"),i+=1);m.appendTo(e),0===i&&e.empty();for(var o in system_values)if(a=[],!(h&&h.split(",").indexOf(o)>=0)){if("system"!==o&&"variable"!==o)for(var p=jQuery(".processor-"+o),q=0;q<p.length;q++)k!==p[q].id&&(a.push(p[q].id),p.length>1&&(b=jQuery("li."+p[q].id+" .processor-line-number"))&&b.html("["+(q+1)+"]"));else a.push("__system__");var r=[];e.data("type")?(r=e.data("type").split(","),r.push("vars")):r=["text","vars"];for(var s=0;s<r.length;s++)if(null!==system_values[o]&&system_values[o].tags&&system_values[o].tags[r[s]])for(var t=0;t<a.length;t++){jQuery("li."+a[t]).index()>jQuery("li."+k).index()&&"__system__"!==a[t]?e.closest(".caldera-editor-processors-panel-wrap").length&&(l=' disabled="disabled"'):l="";for(var m=jQuery('<optgroup label="'+system_values[o].type+("__system__"!==a[t]?" "+jQuery("li."+a[t]).find(".processor-line-number").html():"")+'"'+l+">"),u=0;u<system_values[o].tags[r[s]].length;u++){var v=system_values[o].tags[r[s]][u];"__system__"!==a[t]&&(v=v.replace(o,a[t])),m.append('<option value="{'+v+'}"'+(f==="{"+v+"}"?'selected="selected"':"")+l+">"+system_values[o].tags[r[s]][u]+"</option>"),i+=1}m.children().length&&m.appendTo(e)}}if(0===i){if(e.empty(),e.data("type")){e.append('<option value="">No '+e.data("type").split(",").join(" or ")+" in form</option>");var w=!0}}else e.prop("disabled",!1);e.hasClass("required")||void 0!==w||e.prepend('<option value=""></option>'),e.val(f)}}init_magic_tags(),jQuery(document).trigger("bound.fields"),jQuery(".caldera-header-save-button").prop("disabled",!1),void 0!=typeof cf_revisions_ui&&cf_revisions_ui()}},jQuery(function(a){function b(){var a=jQuery(".layout-grid-panel"),b=0;a.each(function(a,c){var d=jQuery(c),e=d.find(".layout-structure"),f=d.find(".row"),g=[];f.each(function(a,c){var d=jQuery(c),e=d.children().not(".column-merge"),f=[];b+=1,e.each(function(a,c){span=jQuery(c).attr("class").split("-"),f.push(span[2]);var d=jQuery(c).find(".field-location");d.length&&d.each(function(c,d){jQuery(d).val(b+":"+(a+1)).removeAttr("disabled")})}),g.push(f.join(":"))}),e.val(g.join("|"))})}function c(a,b,c){var e,f,g="fld_"+Math.round(1e7*Math.random()),h=g,i=jQuery("#field_config_panels");a.prop("id","").prop("title",""),e=Handlebars.compile(jQuery("#caldera_field_config_wrapper_templ").html()),f=jQuery.extend({},{id:h,label:"",slug:""},c),f.slug="";e(f);i.append(e(f)),a.removeClass("button-small").removeClass("button").removeClass("button-primary").removeClass("ui-draggable").removeClass("layout-new-form-field").addClass("layout-form-field").attr("data-config",g).css({display:"",opacity:""}),a.find(".layout_field_name").remove(),a.find(".field-location").prop("name","config[layout_grid][fields]["+g+"]"),a.find(".settings-panel").show(),a.appendTo(b),d(),a.find(".icon-edit").trigger("click"),jQuery("#"+g+"_lable").focus().select(),baldrickTriggers(),jQuery(document).trigger("field.added",{field:f}),c?jQuery("#"+h+"_type").data("type",f.type).trigger("change"):jQuery("#"+g).trigger("field.drop"),rebuild_field_binding()}function d(){jQuery(".toggle-options").sortable({handle:".dashicons-sort"}),jQuery("#grid-pages-panel").sortable({placeholder:"row-drop-helper",handle:".sort-handle",items:".first-row-level",axis:"y",stop:function(){b()}}),jQuery(".layout-column").sortable({connectWith:".layout-column",appendTo:"#grid-pages-panel",helper:"clone",items:".layout-form-field",handle:".drag-handle",cursor:"move",opacity:.7,cursorAt:{left:100,top:15},start:function(a,b){b.helper.css({width:"200px",height:"35px",paddingTop:"20px"})},stop:function(a,c){c.item.removeAttr("style"),b()}}),jQuery("h3 .layout-new-form-field").draggable({helper:"clone",appendTo:"body"}),jQuery(".page-toggle.button").droppable({accept:".layout-form-field",over:function(a,b){jQuery(this).trigger("click"),jQuery(".layout-column").sortable("refresh")}}),jQuery(".layout-column").droppable({greedy:!0,activeClass:"ui-state-dropper",hoverClass:"ui-state-hoverable",accept:".layout-new-form-field",drop:function(a,b){c(b.draggable.clone(),jQuery(this))}}),b()}function e(){if(h){var a=jQuery(".column-fieldinsert");a.length?(a.stop().fadeToggle(700),jQuery(".layout-new-form-field").stop().fadeToggle(700)):cf_clear_puler()}}function f(){jQuery(".caldera-editor-processors-panel ul").sortable({update:function(){rebuild_field_binding()},create:function(){0==jQuery(".caldera-editor-processors-panel ul").children().length&&(j.addClass("button-primary"),i=new CalderaFormsButtonPulse(j),window.setTimeout(function(){i.startPulse()},3e3))}})}function g(a){
var b=jQuery(a),c=jQuery("#"+b.val()+"-tmpl").length?jQuery("#"+b.val()+"-tmpl").html():"",d=b.closest(".caldera-editor-processor-config-wrapper"),e=d.find(".caldera-config-processor-setup"),f=Handlebars.compile(c),g=d.find(".processor_config_string").val(),h=b.data("type");g=g.length&&h===b.val()?JSON.parse(g):processor_defaults[b.val()+"_cfg"],g||(g={}),g._id=d.prop("id"),g._name="config[processors]["+d.prop("id")+"][config]",f=jQuery("<div>").html(f(g)),e.html(f.html()),"function"==typeof window[b.val()+"_init"]&&window[b.val()+"_init"](d.prop("id"),e),d.find(".no-conditions").length&&d.find(".toggle_option_tab").remove(),rebuild_field_binding(),baldrickTriggers(),jQuery(".wp-baldrick").baldrick({request:cfAdminAJAX,method:"POST",before:function(a){var b=jQuery(a);b.data("addNode")&&!b.data("request")&&b.data("request","cf_get_default_setting")}})}add_new_grid_page=function(a){return{page_no:"pg_"+Math.round(1e7*Math.random())}},add_page_grid=function(a){var b=jQuery(".page-toggle").length+1,c=jQuery('<button type="button" data-name="Page '+b+'" data-page="'+a.rawData.page_no+'" class="page-toggle button">'+a.params.trigger.data("addtitle")+" "+b+"</button> "),e=jQuery("#page-toggles");c.appendTo(e),e.show(),d(),c.trigger("click"),1===b&&e.hide(),jQuery(document).trigger("add.page")},jQuery(document).on("remove.page add.page load.page",function(a){var b=jQuery(".page-toggle").length,c=jQuery("#tab_pages");b<=1?c.hide():c.show()}),d(),jQuery("#grid-pages-panel").on("click",".column-fieldinsert .dashicons-plus-alt",function(a){var b=jQuery(this).closest(".column-container");c(jQuery("#newfield-tool").clone().css("display",""),b)}),jQuery("#grid-pages-panel").on("click",".column-split",function(a){var b=jQuery(this).parent().parent(),c=b.attr("class").split("-"),e=jQuery("<div>").insertAfter(b),f=Math.ceil(c[2]/2),g=Math.floor(c[2]/2);c[2]=f,b.attr("class",c.join("-")),c[2]=g,e.addClass(c.join("-")).append('<div class="layout-column column-container">'),jQuery(this).remove(),d(),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),jQuery("#grid-pages-panel").on("click",".column-remove",function(a){var c=jQuery(this).closest(".row"),d=c.find(".layout-form-field"),e=c.closest(".layout-grid-panel");if(d.length){if(!confirm(jQuery("#row-remove-fields-message").text()))return;d.each(function(a,b){var c=jQuery(b).data("config");jQuery("#"+c).remove(),jQuery('option[value="'+c+'"]').remove(),jQuery('[data-bind="'+c+'"]').remove(),delete current_form_fields[c]})}c.slideUp(200,function(){if(jQuery(this).remove(),b(),rebuild_field_binding(),!e.find(".row").length){e.remove();var a=jQuery("#page-toggles .button-primary"),c=a.prev(),d=a.next();a.remove(),c.length?c.trigger("click"):d.trigger("click")}jQuery(document).trigger("remove.page")}),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),jQuery(".caldera-config-editor-main-panel").on("click",".caldera-add-row",function(a){if(a.preventDefault(),!jQuery(".page-active").length)return void jQuery(".caldera-add-page").trigger("click");var c=jQuery('<div style="display:none;" class="first-row-level row"><div class="col-xs-12"><div class="layout-column column-container"></div></div></div>');jQuery(".page-active").append(c),c.slideDown(200),d(),b()}),jQuery("#grid-pages-panel").on("click",".column-join",function(a){var c=jQuery(this).parent().parent().parent(),d=c.prev(),e=d.attr("class").split("-"),f=c.attr("class").split("-");e[2]=parseFloat(e[2])+parseFloat(f[2]),c.find(".layout-column").contents().appendTo(d.find(".layout-column")),d.attr("class",e.join("-")),c.remove(),b(),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),jQuery("#grid-pages-panel").on("mouseenter",".row",function(a){var c=jQuery(this);jQuery(".column-tools,.column-merge").remove(),c.children().children().first().append('<div class="column-remove column-tools" data-placement="top" title="'+CF_ADMIN_TOOLTIPS.delete_row+'" ><i class="icon-remove"></i></div>'),c.children().children().last().append('<div class="column-sort column-tools" style="text-align:right;"><i class="dashicons dashicons-menu drag-handle sort-handle"></i></div>'),c.children().children().not(":first").prepend('<div class="column-merge"><div class="column-join column-tools"><i class="icon-join"></i></div></div>');var d=c.parent().parent().parent().width()/12-1;c.children().children().each(function(a,b){var c=jQuery(b),d=c.width()/2-5;c.prepend('<div class="column-fieldinsert column-tools"><i class="dashicons dashicons-plus-alt" data-toggle="tooltip" data-placement="top" title="'+CF_ADMIN_TOOLTIPS.add_field_row+'"></i></div>'),c.parent().hasClass("col-xs-1")||(c.prepend('<div class="column-split column-tools" data-placement="top" title="'+CF_ADMIN_TOOLTIPS.split_row+'"><i class="dashicons dashicons-leftright"></i></div>'),c.find(".column-split").css("left",d))}),jQuery(".column-merge").draggable({axis:"x",helper:"clone",appendTo:c,grid:[d,0],drag:function(a,c){jQuery(this).addClass("dragging"),jQuery(".column-tools").remove(),jQuery(".column-split").remove();var d=jQuery(this).parent().parent(),e=c.helper,f=c.originalPosition.left>e.position().left?"left":"right",g=d.prev(),h=Math.round(d.parent().width()/12-10),i=Math.abs(c.originalPosition.left-e.position().left);if(d.parent().addClass("sizing"),i>=h){var j=g.attr("class").split("-"),k=d.attr("class").split("-");j[2]=parseFloat(j[2]),k[2]=parseFloat(k[2]),"left"===f?(j[2]--,k[2]++,j[2]>0&&j[2]<j[2]+k[2]?(g.attr("class",j.join("-")),d.attr("class",k.join("-")),c.originalPosition.left=e.position().left):jQuery(this).draggable("option","disabled",!0)):(j[2]++,k[2]--,k[2]>0&&k[2]<k[2]+k[2]?(g.attr("class",j.join("-")),d.attr("class",k.join("-")),c.originalPosition.left=e.position().left):jQuery(this).draggable("option","disabled",!0)),b()}},stop:function(){jQuery(this).removeClass("dragging").parent().parent().parent().removeClass("sizing")}})}),jQuery("#grid-pages-panel").on("mouseleave",".row",function(a){jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),jQuery("#grid-pages-panel").on("click",".layout-form-field .icon-remove",function(){var a=jQuery(this),b=a.parent(),c=jQuery("#"+b.data("config"));b.slideUp(100,function(){jQuery(this).remove()}),c.slideUp(100,function(){jQuery(this).remove()})}),jQuery(document).on("click",".layout-form-field .dashicons-admin-page",function(){var a=jQuery(this),b=a.parent(),d=b.data("config"),e=jQuery("#"+d).formJSON(),f=a.closest(".column-container"),g=b.clone().css("display",""),h={};b.hasClass("field-edit-open")&&(b.removeClass("field-edit-open"),g.removeClass("field-edit-open"),jQuery(".caldera-editor-field-config-wrapper").hide()),e.config.fields[d]&&(h=e.config.fields[d],delete h.ID),c(g,f,h)}),jQuery(document).on("click",".layout-form-field .icon-edit",function(){var a=jQuery(this),b=a.parent(),c=jQuery("#"+b.data("config")+"_type").val();jQuery(".caldera-editor-field-config-wrapper").hide(),b.hasClass("field-edit-open")?b.removeClass("field-edit-open"):(jQuery(".layout-form-field").removeClass("field-edit-open"),b.addClass("field-edit-open"),jQuery("#"+b.data("config")).show()),jQuery(document).trigger("show."+b.data("config")),jQuery(document).trigger("show.fieldedit"),"radio"!==c&&"checkbox"!==c&&"dropdown"!==c&&"toggle_switch"!==c||jQuery("#"+b.data("config")+"_auto").trigger("change")}),jQuery("body").on("click",".layout-modal-edit-closer,.layout-modal-save-action",function(a){a.preventDefault();var b=jQuery(this),c=jQuery(".layout-form-field.edit-open"),d=b.closest(".layout-modal-container");settings=d.find(".settings-panel").first(),jQuery(".edit-open").removeClass("edit-open"),settings.appendTo(c.find(".settings-wrapper")).hide(),d.hide()}),jQuery(".layout-editor-body").on("change",".layout-core-pod-query",function(){jQuery(this).parent().find(".settings-panel-row").remove(),jQuery(".edit-open").find(".drag-handle .set-pod").html(" - "+jQuery(this).val())}),jQuery(".layout-editor-body").on("click",".remove-where",function(){jQuery(this).closest(".settings-panel-row").remove()}),jQuery(".layout-editor-body").on("click",".use-pod-container",function(){var a=jQuery(this),b=a.prev(),c=b.val();if(c.length){jQuery(".edit-open").find(".drag-handle .set-pod").html(" - "+b.val()),a.parent().parent().find(".spinner").css("display","inline-block");var d={action:"pq_loadpod",pod_reference:{pod:c}};jQuery.post(cfAdminAJAX,d,function(b){a.parent().find(".spinner").css("display","none");var c=jQuery("#where-line-tmpl").html(),d="",e=a.closest(".settings-panel").data("container");for(var f in b)d+='<option value="'+b[f]+'">'+b[f]+"</option>";c=c.replace(/{{fields}}/g,d).replace(/{{container_id}}/g,e),a.parent().append(c)})}}),jQuery(".caldera-editor-header").on("click",".column-sort .icon-edit",function(a){}),jQuery(".layout-editor-body").on("tray_loaded",".layout-template-tray",function(){d()}),jQuery(".caldera-editor-header").on("click",".caldera-editor-header-nav a",function(a){a.preventDefault();var b=jQuery(this);jQuery(".caldera-editor-header-nav li").removeClass("active"),jQuery(".caldera-editor-body").hide(),jQuery(b.attr("href")).show(),b.parent().addClass("active"),rebind_field_bindings()}),jQuery("body").on("change",".required",function(){check_required_bindings(this)}),jQuery("body").on("submit",".caldera-forms-options-form",function(a){jQuery(".required.has-error").length&&a.preventDefault()}),jQuery(".caldera-editor-body").on("click",".add-toggle-option",function(a){var b=jQuery(this);if(b.data("bulk"))return jQuery(b.data("bulk")).toggle(),void jQuery(b.data("bulk")).find("textarea").focus();var c=b.closest(".caldera-editor-field-config-wrapper"),d=c.find(".toggle-options"),e=jQuery("#field-option-row-tmpl").html(),f=Handlebars.compile(e),g="opt"+parseInt(1048576*(Math.random()+1)),h={_name:"config[fields]["+c.prop("id")+"][config]",option:{}};if(b.data("options")){for(var i=jQuery(b.data("options")),j=i.val().split("\n"),k=!1,l=0;l<j.length;l++){var m=j[l],n=m,o=n.split("|");if(o.length>1){n=o[0],m=o[1],k=!0;var p=o[2]||!1}h.option["opt"+parseInt(1048576*(Math.random()+l))]={value:n,calc_value:p||n,label:m,default:!1}}jQuery(b.data("options")).parent().hide(),i.val(""),!0===k?c.find(".toggle_show_values").prop("checked",!0):c.find(".toggle_show_values").prop("checked",!1),d.empty()}else h.option[g]={value:"",label:"",calc_value:"",default:!1};jQuery(".preset_options").val(""),d.append(f(h)),c.find(".toggle_show_values").trigger("change"),jQuery(".toggle-options").sortable({handle:".dashicons-sort"}),j||d.find(".toggle_label_field").last().focus()}),jQuery(".caldera-editor-body").on("change",".preset_options",function(a){var b=jQuery(this),c=b.val(),d=jQuery(b.data("bulk"));preset_options&&preset_options[c]&&preset_options[c].data&&("object"==typeof preset_options[c].data&&preset_options[c].data.length&&(preset_options[c].data=preset_options[c].data.join("\n")),d.val(preset_options[c].data))}),jQuery(".caldera-editor-body").on("click",".toggle-remove-option",function(a){var b=jQuery(this).closest(".caldera-editor-field-config-wrapper").find(".field-config").first();jQuery(this).parent().remove(),b.trigger("change"),jQuery(document).trigger("option.remove")}),jQuery(".caldera-editor-body").on("click",".page-toggle",function(a){var b=jQuery(this),c=b.parent(),d=c.find(".button");d.removeClass("button-primary"),jQuery(".layout-grid-panel").hide().removeClass("page-active"),jQuery("#"+b.data("page")).show().addClass("page-active"),b.addClass("button-primary"),d.each(function(a,b){jQuery(b).html(c.data("title")+" "+(a+1))}),1===d.length&&c.hide()}),jQuery(".caldera-editor-body").on("blur toggle.values",".toggle_label_field",function(a){var b=jQuery(this),c=jQuery('.toggle_value_field[data-opt="'+b.data("option")+'"]');c.is(":visible")||c.val(b.val())}),jQuery(document).on("change focusout",".toggle_value_field",function(){jQuery(document).trigger("show.fieldedit")}),jQuery(document).on("show.fieldedit option.remove",function(a){jQuery(".toggle_value_field.has-error").removeClass("has-error");for(var b=jQuery("#"+jQuery(".layout-form-field.field-edit-open").data("config")),c=b.find(".toggle_value_field"),d=b.find(".notice"),e=0,f=0;f<c.length;f++){for(var g=(c[f].value,0),h=0;h<c.length;h++)c[f]!==c[h]&&c[f].value===c[h].value&&(jQuery(c[h]).addClass("has-error"),g++);g>0&&(jQuery(c[f]).addClass("has-error"),e++)}e>0?(d.slideDown(),a.preventDefault()):d.slideUp()});var h=!1;focus_initial_field=function(a){var b=jQuery(".layout-grid-panel .icon-edit").first();b.length?b.trigger("click"):(jQuery(".layout-column.column-container").first().trigger("mouseover"),h=setInterval(e,500)),jQuery(document).off("load.page",focus_initial_field)},jQuery(document).on("load.page",focus_initial_field),cf_clear_puler=function(){h&&(clearTimeout(h),jQuery(document).off("mouseover",".layout-new-form-field, .column-fieldinsert",cf_clear_puler)),jQuery(".layout-new-form-field, .column-fieldinsert").fadeIn()},jQuery(document).on("mouseover",".layout-new-form-field, .column-fieldinsert",cf_clear_puler),rebuild_field_binding(),jQuery(document).trigger("load.page");var i,j=jQuery(".new-processor-button");jQuery("body").on("click",".caldera-processor-nav a",function(a){a.preventDefault();var b=jQuery(this);jQuery(".caldera-processor-nav").removeClass("active"),jQuery(".caldera-editor-processor-config-wrapper").hide(),jQuery(b.attr("href")).show(),b.parent().addClass("active")}),jQuery("body").on("click",".add-new-processor",function(a){"object"==typeof i&&(j.removeClass("button-primary"),i.stopPulse());var b=jQuery(this),c=Handlebars.compile(jQuery("#processor-wrapper-tmpl").html());wrap=jQuery(".active-processors-list"),process_conf=jQuery(".caldera-editor-processor-config"),processid=Math.round(1e8*Math.random()),new_templ=Handlebars.compile(jQuery("#processor-line-tmpl").html()),new_proc={id:"fp_"+processid,type:b.data("type")},wrap.append(new_templ(new_proc)),process_conf.append(c(new_proc)),jQuery("#form_processor_baldrickModalCloser").trigger("click"),jQuery(".caldera-processor-nav a").last().trigger("click"),jQuery("#fp_"+processid+"_type").val(b.data("type")).trigger("change"),f(),baldrickTriggers(),jQuery(document).trigger("processor.added",{processor:new_proc})}),jQuery("body").on("click",".delete-processor",function(a){var b=jQuery(this),c=b.closest(".caldera-editor-processor-config-wrapper");c.data("type");confirm(b.data("confirm"))&&(jQuery("."+c.prop("id")).remove(),c.remove(),jQuery(".caldera-processor-nav a").first().trigger("click"),rebuild_field_binding())}),jQuery("body").on("change",".caldera-select-processor-type",function(a){var b=jQuery(this),c=b.closest(".caldera-editor-processor-config-wrapper"),d=b.find('option[value="'+b.val()+'"]').text(),e=c.find(".caldera-editor-processor-title"),f=jQuery(".caldera-processor-nav.active a");""===d&&(d=e.data("title")),e.html(d),f.html(d+' <span class="processor-line-number"></span>').parent().addClass("processor_type_"+b.val()),g(this),rebuild_field_binding()}),jQuery(document).on("click","#cf-shortcode-preview",function(){jQuery(this).focus().select()}),jQuery(document).on("change",".cf-email-preview-toggle",function(){var a=jQuery(this),b=jQuery(".caldera-header-email-preview-button");a.is(":checked")?b.show().attr("aria-hidden","false").css("visibility","visible"):b.hide().attr("aria-hidden","true").css("visibility","hidden")}),rebuild_field_binding(),jQuery(".caldera-select-processor-type").each(function(a,b){g(b)}),f()}),Handlebars.registerHelper("_field",function(a){var b=this,c="",d="",e="",f=this[a.hash.slug]?' data-default="'+this[a.hash.slug]+'"':"";a.hash.required&&(c=" required"),a.hash.exclude&&(e='data-exclude="'+a.hash.exclude+'"'),a.hash.array&&(d="[]","true"!==a.hash.array&&(f='value="'+a.hash.array+'"')),out="<select "+(a.hash.type?'data-type="'+a.hash.type+'"':"")+f+" "+e+' name="'+this._name+"["+a.hash.slug+"]"+d+'" id="'+this._id+"_"+a.hash.slug+'" class="block-input field-config caldera-field-bind'+c+'">',this[a.hash.slug]?out+='<option class="bound-field" value="'+this[a.hash.slug]+'" class="bound-field"></option>':a.hash.required||(out+='<option value=""></option>');for(var g in current_form_fields){var h="";a.hash.type&&current_form_fields[g].type!==a.hash.type||(b[a.hash.slug]&&b[a.hash.slug]===g&&(h=' selected="selected"'),out+='<option value="'+g+'"'+h+">"+current_form_fields[g].label+" ["+current_form_fields[g].slug+"]</option>")}return out+="</select>",a.hash.required&&(out+='<input class="field-config" name="'+this._name+'[_required_bounds][]" type="hidden" value="'+a.hash.slug+'">'),out}),Handlebars.registerHelper("console",function(a,b){console.log(this)});var revisions={};jQuery(document).ready(function(a){function b(b){var d=a(b),e=d.closest(".caldera-editor-field-config-wrapper"),f=e.find(".caldera-config-field-setup"),g=compiled_templates[d.val()+"_tmpl"]?compiled_templates[d.val()+"_tmpl"]:compiled_templates.noconfig_field_templ,h=e.find(".field_config_string").val(),i=d.data("type");if(e.find(".caldera-config-group").show(),d.addClass("field-initialized"),h=h.length&&i===d.val()?JSON.parse(h):fieldtype_defaults[d.val()+"_cfg"],h||(h={}),h._id=d.data("field"),h._name="config[fields]["+d.data("field")+"][config]",g=a("<div>").html(g(h)),f.html(g.html()),"function"==typeof window[d.val()+"_init"]&&window[d.val()+"_init"](d.data("field"),f),fieldtype_defaults[d.val()+"_nosupport"]&&(fieldtype_defaults[d.val()+"_nosupport"].indexOf("hide_label")>=0&&e.find(".hide-label-field").hide().find(".field-config").prop("checked",!1),fieldtype_defaults[d.val()+"_nosupport"].indexOf("caption")>=0&&e.find(".caption-field").hide().find(".field-config").val(""),fieldtype_defaults[d.val()+"_nosupport"].indexOf("required")>=0&&e.find(".required-field").hide().find(".field-config").prop("checked",!1),fieldtype_defaults[d.val()+"_nosupport"].indexOf("custom_class")>=0&&e.find(".customclass-field").hide().find(".field-config").val(""),fieldtype_defaults[d.val()+"_nosupport"].indexOf("entry_list")>=0&&e.find(".entrylist-field").hide().find(".field-config").prop("checked",!1)),e.find(".toggle_show_values").trigger("change"),!a(".caldera-select-field-type").not(".field-initialized").length){if(core_form||(core_form=jQuery(".caldera-forms-options-form")),core_form.hasClass("builder-loaded"))c(d.data("field"));else{for(var j=a(".caldera-select-field-type.field-initialized"),k=0;k<j.length;k++)c(a(j[k]).data("field"));core_form.addClass("builder-loaded")}a(".caldera-header-save-button").prop("disabled",!1),rebuild_field_binding(),baldrickTriggers()}a(".color-field").length&&a(".color-field").wpColorPicker({change:function(b){var c=a(this);c.data("ev")&&clearTimeout(c.data("ev")),c.data("ev",setTimeout(function(){c.trigger("record")},200)),c.data("target")&&(a(c.data("target")).css(c.data("style"),c.val()),a(c.data("target")).val(c.val()))}})}function c(b){var c=a("#"+b),d=c.find(".caldera-select-field-type"),e=a('.layout-form-field[data-config="'+b+'"]'),f=e.find(".field_preview"),g=(a("#preview-"+d.val()+"_tmpl").html(),compiled_templates["preview-"+d.val()+"_tmpl"]),h={id:b};c.find(".field-config").each(function(c,d){for(var e=a(d),f=e.prop("name").split("["+b+"]")[1].substr(1),g=f.substr(0,f.length-1).split("]["),i=e.is(":checkbox,:radio")?e.filter(":checked").val():e.val(),j={},k=g.length-1;k>=0;k--)if(k===g.length-1)j[g[k]]=i;else{var l=j;j={},j[g[k]]=l}a.extend(!0,h,j)}),f.html(g(h)),e.removeClass("button"),a(".preview-field-config").prop("disabled",!0)}function d(b){var c,d=a(".caldera-editor-fields-panel"),e=(a(".caldera-editor-groups-panel"),a(".caldera-group-nav")),f=a('[data-group="'+b+'"]'),g=f.find(".caldera-config-group-name"),h=f.find(".caldera-config-group-slug"),i=f.find(".caldera-config-group-desc"),j=f.find(".caldera-config-group-admin"),k=a(".active-group-name"),l=a(".active-group-slug"),m=a(".active-group-desc"),n=a(".active-group-admin"),o=a(".caldera-editor-fields-list ul"),p=f.find(".caldera-config-group-repeat"),q=a(".repeat-config-button"),r=(a(".caldera-editor-group-settings"),a(".caldera-config-group-remove"));a(".new-group-input").remove(),a(".new-field-input").remove(),e.removeClass("active"),d.show(),o.hide(),o.removeClass("active").find("li.active").removeClass("active"),o.hide(),f.addClass("active"),c=a(".caldera-editor-fields-list ul.active li"),c.length?r.hide():r.show(),a(".caldera-editor-field-config-wrapper").hide(),f.show(),k.val(g.val()),l.val(h.val()),m.val(i.val()),"1"===j.val()?n.prop("checked",!0):n.prop("checked",!1),"1"===p.val()?q.addClass("field-edit-open"):q.removeClass("field-edit-open")}a(".caldera-header-save-button").baldrick({method:"POST",request:"admin.php?page=caldera-forms",before:function(b,c){if(c.preventDefault(),!check_required_bindings())return!1;a("#save_indicator").addClass("loading"),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();var d=a(".caldera-forms-options-form").formJSON();return d.conditions&&(d.config.conditional_groups={conditions:d.conditions}),a(b).data("cf_edit_nonce",d.cf_edit_nonce),a(b).data("_wp_http_referer",d._wp_http_referer),a(b).data("sender","ajax"),a(b).data("config",JSON.stringify(d.config)),!0},callback:function(b){if(!1===b.data){var c=a(".updated_notice_box");c.stop().animate({top:0},200,function(){setTimeout(function(){c.stop().animate({top:-75},200)},2e3)})}},complete:function(b){a(".wrapper-instance-pane .field-config").prop("disabled",!1)}}),a("body").on("click",".toggle_processor_event input",function(b){var c=a(this),d=c.closest(".wrapper-instance-pane"),e=d.find(".caldera-config-processor-setup"),f=d.find(".caldera-config-processor-notice");c.is(":checked")?(c.parent().addClass("activated"),c.parent().find(".is_active").show().attr("aria-hidden",!1).css("visibility","visible"),c.parent().find(".not_active").hide().attr("aria-hidden",!0).css("visibility","hidden")):(c.parent().removeClass("activated"),c.parent().find(".is_active").hide().attr("aria-hidden",!0).css("visibility","hidden"),c.parent().find(".not_active").show().attr("aria-hidden",!1).css("visibility","visible")),d.find(".toggle_processor_event .activated").length?(e.slideDown(100),f.slideUp(100)):(e.slideUp(100),f.slideDown(100))}),a("body").on("click",".toggle_option_tab > a",function(b){b.preventDefault();var c=a(this),d=a(c.attr("href")),e=c.parent().find("a"),f=c.closest(".caldera-editor-config-wrapper").find(".wrapper-instance-pane");e.removeClass("button-primary"),f.hide(),d.show(),c.addClass("button-primary"),a(".caldera-conditionals-usetype").trigger("change")}),a(".caldera-editor-body").on("change",".caldera-select-field-type",function(a){b(this)}),a(".caldera-editor-body").on("click",".caldera-group-nav a",function(b){b.preventDefault(),d(a(this).attr("href").substr(1))}),a(".caldera-editor-body").on("click",".caldera-editor-fields-list a",function(b){b.preventDefault();var c=a(this),d=a(c.attr("href"));a(".new-group-input").remove(),a(".new-field-input").remove(),a(".caldera-editor-fields-list li.active").removeClass("active"),c.parent().addClass("active"),a(".caldera-editor-field-config-wrapper").hide(),d.show()}),a(".caldera-editor-body").on("click",".group-config-button",function(b){var c=a(this),d=a(".caldera-editor-group-settings"),e=c.closest(".caldera-editor-fields-panel"),f=a(".caldera-config-group-remove");e.find(".caldera-field-line").length?f.hide():f.show(),c.hasClass("field-edit-open")?(d.slideUp(100),c.removeClass("field-edit-open")):(d.slideDown(100),c.addClass("field-edit-open"))}),a(".caldera-editor-body").on("keydown",".field-config",function(b){a(this).is("textarea")||13===b.which&&b.preventDefault()}),a(".caldera-editor-body").on("change",".field-label",function(b){var c=a(this).closest(".caldera-editor-field-config-wrapper").prop("id");field_line=a('[data-field="'+c+'"]'),field_title=a("#"+c+" .caldera-editor-field-title, .layout-form-field.field-edit-open .layout_field_name"),slug=a("#"+c+" .field-slug"),field_line.find("a").html('<i class="icn-field"></i> '+this.value),field_title.text(this.value),"change"===b.type&&slug.trigger("change"),rebuild_field_binding()}),a(".caldera-editor-body").on("change",".active-group-name",function(b){b.preventDefault();var c=a(".caldera-group-nav.active"),d=(c.data("group"),c.find(".caldera-config-group-name")),e=c.find("span");"focusout"!==b.type||this.value.length||(this.value="Group "+(parseInt(c.index())+1)),d.val(this.value),e.text(this.value)}),a(".caldera-editor-body").on("change",".active-group-slug",function(b){b.preventDefault();var c=a(".caldera-group-nav.active"),d=(c.data("group"),c.find(".caldera-config-group-name").val()),e=c.find(".caldera-config-group-slug"),f=(c.find("span"),this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase());"focusout"!==b.type||this.value.length||(f=d.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase()),e.val(f),this.value=f}),a(".caldera-editor-body").on("change",".active-group-desc",function(b){b.preventDefault();var c=a(".caldera-group-nav.active");(c.data("group"),c.find(".caldera-config-group-desc")).val(this.value)}),a(".caldera-editor-body").on("change",".active-group-admin",function(b){b.preventDefault();var c=a(".caldera-group-nav.active"),d=(c.data("group"),c.find(".caldera-config-group-name").val(),c.find(".caldera-config-group-admin"));c.find("span"),this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),a(this).prop("checked")?(d.val(1),c.addClass("is-admin")):(d.val(0),c.removeClass("is-admin"))}),a(".caldera-editor-body").on("click",".repeat-config-button",function(b){b.preventDefault();var c=a(".caldera-group-nav.active"),d=(c.data("group"),c.find("a .group-type")),e=c.find(".caldera-config-group-repeat"),f=a(this);f.hasClass("field-edit-open")?(e.val("0"),d.removeClass("icn-repeat").addClass("icn-folder"),f.removeClass("field-edit-open")):(e.val("1"),d.addClass("icn-repeat").removeClass("icn-folder"),f.addClass("field-edit-open"))}),a(".caldera-editor-body").on("click",".delete-field",function(){var b=a(this),c=b.closest(".caldera-editor-field-config-wrapper").prop("id");confirm(b.data("confirm"))&&(a("#"+c).remove(),a('option[value="'+c+'"]').remove(),a('[data-bind="'+c+'"]').remove(),delete current_form_fields[c],a('[data-config="'+c+'"]').slideUp(200,function(){a(this).remove(),rebuild_field_binding(),a(document).trigger("field.removed")}))}),a(".caldera-editor-body").on("click",".add-new-group,.add-field",function(){var b=a(this);if(a(".new-group-input").remove(),a(".new-field-input").remove(),b.hasClass("add-field")){a('<input type="text" class="new-field-input block-input">').appendTo(a(".caldera-editor-fields-list ul.active")).focus()}else{a('<input type="text" class="new-group-input block-input">').appendTo(a(".caldera-editor-groups-panel")).focus()}}),a(".caldera-editor-body").on("change keypress",".new-group-input",function(b){if("keypress"===b.type){if(13!==b.which)return;b.preventDefault()}var c,e,f=this.value,g=a(this),h=a(".caldera-editor-groups-panel ul"),i=a(".caldera-editor-fields-list");if(f.length){c=Handlebars.compile(a("#caldera_group_line_templ").html()),e={id:f.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),name:f},h.append(c(e));a('<ul data-group="'+e.id+'">').hide().appendTo(i),g.remove(),d(e.id)}else g.remove()}),a(".caldera-editor-body").on("change keypress",".new-field-input",function(b){if("keypress"===b.type){if(13!==b.which)return;b.preventDefault()}var c,d,e,f=this.value,g=a(this),h=g.parent(),i=a(".caldera-editor-field-config"),j=a(".caldera-config-group-remove");if(f.length){j.hide(),c=Handlebars.compile(a("#caldera_field_line_templ").html()),d=Handlebars.compile(a("#caldera_field_config_wrapper_templ").html()),e={id:f.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),label:f,slug:f.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),group:a(".caldera-group-nav.active").data("group")};var k=a(c(e));k.appendTo(h),i.append(d(e)),k.find("a").trigger("click"),g.remove()}else g.remove()}),a(".caldera-editor-body").on("change",".field-slug",function(b){this.value.length?this.value=this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase():"change"===b.type&&(this.value=a(this).closest(".caldera-editor-field-config-wrapper").find(".field-label").val().split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase())}),a(".caldera-editor-body").on("click",".caldera-add-group",function(b){var c=a(this),d=c.data("group"),e=a("#"+d+"_panel_tmpl").html();c.parent().parent().append(e)}),a(".caldera-editor-body").on("click",".caldera-config-group-remove",function(b){var c=a(".active-group-slug").val();a('[data-group="'+c+'"]').hide(0,function(){a(this).remove();var b=a(".caldera-group-nav");b.length?b.first().find("a").trigger("click"):a(".caldera-editor-fields-panel").hide()})}),a("body").on("click",".set-current-field",function(b){b.preventDefault();var c=a(this);a("#"+c.data("field")+"_type").val(c.data("type")).trigger("change"),a("#"+c.data("field")+"_lable").focus(),a("#field_setup_baldrickModalCloser").trigger("click")}),a(".caldera-editor-body").on("change record",".field-config",function(b){var d=a(this),e=d.closest(".caldera-editor-field-config-wrapper");current_form_fields&&(d.prop("id")===e.prop("id")+"_lable"&&(current_form_fields[e.prop("id")].label=this.value),d.prop("id")===e.prop("id")+"_slug"&&(current_form_fields[e.prop("id")].slug=this.value),d.prop("id")===e.prop("id")+"_type"&&(current_form_fields[e.prop("id")].type=this.value),e.length&&c(e.prop("id")))}),a(".caldera-editor-body").on("focus",".caldera-field-bind",function(b){var c=a(this),d=this.value;if(b.type&&"focusin"===b.type)return c.removeClass("bound_field").addClass("reload-binding"),rebind_field_bindings(),void(this.value=d)}),a(".caldera-editor-body").on("change",".caldera-conditional-field-set",function(b){var c,d,e=a(this),f=e.parent().find(".compare-type"),g=e.data("condition"),h=e.data("id"),i="config["+g+"]["+h+"][conditions][group]["+e.data("row")+"]["+e.data("line")+"]",j=e.data("line"),k=a("#"+j+"_value"),l=k.find(".caldera-conditional-value-field").first(),m=[],n=this.value;if("{"!==n.substr(0,1)&&(c=a("#"+n),d=c.find(".field-button-type"),m=c.find(".caldera-config-group-toggle-options")),e.hasClass(".bind_init")&&e.addClass("bound_triggered"),l.length&&l.val().length&&k.data("value",l.val()),f.show(),m.length){var o=m.find(".toggle_option_row"),p='<select name="'+i+'[value]" class="caldera-processor-value-bind caldera-conditional-value-field" data-field="'+n+'" style="max-width: 220px; width: 220px;">';p+='<option value=""></option>',o.each(function(b,c){var d=a(c).find(".toggle_label_field"),e=d.data("option"),f="";k.data("value")&&(k.data("value").toString()!==e&&k.data("value").toString()!==a(c).find(".toggle_value_field").val()||(f=' selected="selected"')),p+='<option value="'+e+'"'+f+">"+d.val()+"</option>"}),p+="</select>"}else d&&"button"==d.val()?(f.val("is").hide(),p='<select name="'+i+'[value]" class="caldera-processor-value-bind caldera-conditional-value-field" data-field="'+n+'" style="max-width: 220px; width: 220px;">',p+='<option value="click" '+("click"===k.data("value")?'selected="selected"':"")+">Click</option>",p+='<option value="dblclick" '+("dblclick"===k.data("value")?'selected="selected"':"")+">Double Click</option>",p+="</select>"):p='<input name="'+i+'[value]" type="text" class="caldera-conditional-value-field magic-tag-enabled" value="'+(k.data("value")?k.data("value"):"")+'" style="max-width: 205px;">';k.html(p),init_magic_tags()}),a(".caldera-editor-body").on("change",".caldera-conditionals-usetype",function(b){var c=a(this);"show"===this.value||"hide"===this.value||"disable"===this.value||"use"===this.value||"not"===this.value?(a("#"+c.data("id")+"_condition_group_add").show(),
a("#"+c.data("id")+"_conditional_wrap").show()):(a("#"+c.data("id")+"_condition_group_add").hide(),a("#"+c.data("id")+"_conditional_wrap").hide())}),a(".caldera-editor-body").on("click",".remove-conditional-line",function(b){b.preventDefault();var c=a(this),d=c.closest(".caldera-condition-line"),e=c.closest(".caldera-condition-group");d.remove(),e.find(".caldera-condition-line").length||e.remove()}),a(".caldera-group-nav").first().find("a").trigger("click"),a(".caldera-editor-body").on("change",".toggle_show_values",function(b){var c=a(this),d=c.closest(".caldera-config-group-toggle-options");values=d.find(".toggle_value_field"),lables=d.find(".toggle_label_field"),field_lables=d.find(".caldera-config-group-option-labels"),c.prop("checked")?(values.show().parent().show(),values.show().parent().parent().show(),lables.css("width",""),field_lables.show()):(values.hide().parent().hide(),lables.css("width",245),field_lables.hide()),lables.trigger("toggle.values"),init_magic_tags()}),a(".caldera-editor-body").on("change",".auto-populate-type",function(){a(this).closest(".wrapper-instance-pane").find(".auto-populate-options").trigger("change")}),a(".caldera-editor-body").on("change",".auto-populate-options",function(){var b=a(this),c=b.closest(".wrapper-instance-pane"),d=c.find(".caldera-config-group-toggle-options"),e=c.find(".caldera-config-group-auto-options"),f=e.find(".auto-populate-type");e.find(".auto-populate-type-panel").hide(),b.prop("checked")?(d.hide(),e.show()):(d.show(),e.hide()),e.find(".caldera-config-group-auto-"+f.val()).show()}),a("body").on("change",".pin-toggle-roles",function(){var b=a(this),c=a("#caldera-pin-rules");"1"===b.val()?c.show():c.hide()}),a("body").on("click",".magic-tag-init",function(b){a(this).prev().focus().trigger("init.magic")}),a("body").on("keyup  focus select click init.magic",".magic-tag-enabled",function(b){init_magic_tags();var c=a(this),d=c.parent(),e=d.closest(".wrapper-instance-pane").find(".caldera-select-field-type").val()?d.closest(".wrapper-instance-pane").find(".caldera-select-field-type").val():"hidden",f=d.find(".magic-tags-autocomplete"),g=f.find("ul"),h=this.value,i=[],j="",k=this.selectionStart,l=this.selectionEnd;if(f.length&&f.data("focus"))return void b.preventDefault();if(c.data("tag",""),this.selectionEnd>this.selectionStart)j=this.value.substr(this.selectionStart,this.selectionEnd-this.selectionStart);else if(("select"===b.type||"keyup"===b.type)&&40!==b.which&&38!==b.which&&39!==b.which&&37!==b.which){for(k=this.selectionStart;k>0;k--){var m=h.substr(k-1,1);if(" "===m||"\n"===m||("%"===m||"}"===m)&&this.selectionStart===k)break}for(l=this.selectionStart;l<h.length;l++){var m=h.substr(l,1);if(" "===m||"\n"===m||("%"===m||"{"===m)&&this.selectionStart===l)break}j=h.substr(k,l-k)}if("focusout"!==b.type){"init"!==b.type&&j.length<3&&f.length&&f.remove(),f.length||(f=a('<div class="magic-tags-autocomplete"></div>'),g=a("<ul></ul>"),g.appendTo(f),f.insertAfter(c),f.on("mouseenter",function(){a(this).data("focus",!0)}),f.on("mouseleave",function(){a(this).data("focus",!1),setTimeout(function(){f.remove()},200),c.is(":focus")||c.trigger("focusout")})),g.empty();var n="system",o=!1;"hidden"===e||"dropdown"===e||"radio"===e||"toggle_switch"===e||"checkbox"===e?(o=!0,e="text",n="all"):"paragraph"!==e&&"html"!==e||(e="text"),c.data("type")&&(e=c.data("type")),e=e.split(","),e.push("vars");for(var p=0;p<e.length;p++)for(var q in system_values)if(void 0!==system_values[q].tags&&void 0!==system_values[q].tags[e[p]]){if(i=[q],"system"!==q&&"variable"!==q&&"field"!==q){var r=jQuery(".processor-"+q),s=c.closest(".caldera-editor-processor-config-wrapper"),t=s.prop("id");i=[];for(var u=0;u<r.length;u++)if(s.length||!0!==o){if(t===r[u].id)continue;jQuery("li."+r[u].id).index()<jQuery("li."+t).index()&&i.push(r[u].id)}else i.push(r[u].id)}for(var v=0;v<i.length;v++)if("all"===n||n===q||"variable"===q){var w=a('<li class="header">'+system_values[q].type+(v>0?" ["+(v+1)+"]":"")+"</li>"),x=0;w.appendTo(g);for(var y=0;y<system_values[q].tags[e[p]].length;y++)if(!c.data("parent")||"variable:"+c.data("parent")!==system_values[q].tags[e[p]][y]){var z=system_values[q].wrap[0]+system_values[q].tags[e[p]][y]+system_values[q].wrap[1];if(i[v]!==q&&i.length>1&&(z=system_values[q].wrap[0]+system_values[q].tags[e[p]][y]+":"+i[v]+system_values[q].wrap[1]),z.indexOf(j)>=0||"init"===b.type){x+=1;var A=z.replace(j,"<strong>"+j+"</strong>"),B=a('<li class="tag" data-tag="'+z+'">'+A+"</li>");B.on("click",function(){var b=a(this).data("tag");c.val(h.substr(0,k)+b+h.substr(l)).trigger("change").focus(),c[0].selectionStart=k+b.length-(b.indexOf("*")>0?2:0),c[0].selectionEnd=k+b.length-(b.indexOf("*")>0?1:0),l=k=c[0].selectionEnd,h+=b,c.trigger("init.magic")}),B.appendTo(g)}}0===x&&w.remove()}}}g.children().length||f.remove(),"focusout"===b.type&&setTimeout(function(){f.remove()},200)});for(var e=a(".cf-editor-template"),f=0;f<e.length;f++)compiled_templates[e[f].id]=Handlebars.compile(e[f].innerHTML);a(".caldera-select-field-type").not(".field-initialized").each(function(a,c){b(c)})});var rebuild_field_binding,rebind_field_bindings,current_form_fields={},required_errors={},add_new_grid_page,add_page_grid,init_magic_tags,core_form,compiled_templates={};init_magic_tags=function(){jQuery(".magic-tag-enabled").each(function(a,b){var c=jQuery(b);if(c.hasClass("magic-tag-init-bound")){var d=c.parent().find(".magic-tag-init");return void(c.is(":visible")?d.show():d.hide())}var e=jQuery('<span class=""></span>'),f=jQuery('<span style="position:relative;display:inline-block; width:100%;"></span>');c.is("input")&&e.css("borderBottom","none"),c.hasClass("caldera-conditional-value-field")&&f.width("auto"),c.wrap(f),e.insertAfter(c),c.addClass("magic-tag-init-bound"),c.is(":visible")?e.show():e.hide()})},rebuild_field_binding=function(){if(core_form||(core_form=jQuery(".caldera-forms-options-form")),core_form.hasClass("builder-loaded")){var a=jQuery(".caldera-editor-field-config-wrapper");system_values.field={tags:{text:[]},type:"Fields",wrap:["%","%"]};for(var b=0;b<a.length;b++){var c=a[b].id,d=jQuery("#"+c+"_lable").val(),e=jQuery("#"+c+"_slug").val(),f=jQuery("#"+c+"_type").val();void 0===system_values.field.tags[f]&&(system_values.field.tags[f]=[]),system_values.field.tags[f].push(e),"text"!==f&&system_values.field.tags.text.push(e),current_form_fields[c]={label:d,slug:e,type:f},jQuery("option.bound-field").trigger("change").each(function(a,b){var c=jQuery(b);0!==c.prop("value").indexOf("{")?c.text(jQuery("#"+c.prop("value")+"_lable").val()+" ["+jQuery("#"+c.prop("value")+"_lable").val()+"]"):c.text(c.prop("value").replace("{","").replace("}",""))}).removeClass("bound-field")}}},rebind_field_bindings=function(){var a,b,c=jQuery(".caldera-field-bind").not(".bound_field");if(c.length){c.addClass("bound_field");for(var d=0;d<c.length;d++){var e=jQuery(c[d]),f=e.val(),g=e.data("default"),h=e.data("exclude"),i=0,j=e.closest(".caldera-editor-processor-config-wrapper"),k=j.prop("id"),l="";if(g&&!e.hasClass("reload-binding")&&(f=g),e.is("select")){e.empty();var m=jQuery('<optgroup label="Fields">');for(var n in current_form_fields)e.data("type")&&e.data("type").split(",").indexOf(current_form_fields[n].type)<0||(e.data("id")!==n&&m.append('<option value="'+n+'"'+(f===n?'selected="selected"':"")+">"+current_form_fields[n].label+" ["+current_form_fields[n].slug+"]</option>"),i+=1);m.appendTo(e),0===i&&e.empty();for(var o in system_values)if(a=[],!(h&&h.split(",").indexOf(o)>=0)){if("system"!==o&&"variable"!==o)for(var p=jQuery(".processor-"+o),q=0;q<p.length;q++)k!==p[q].id&&(a.push(p[q].id),p.length>1&&(b=jQuery("li."+p[q].id+" .processor-line-number"))&&b.html("["+(q+1)+"]"));else a.push("__system__");var r=[];e.data("type")?(r=e.data("type").split(","),r.push("vars")):r=["text","vars"];for(var s=0;s<r.length;s++)if(system_values[o].tags&&system_values[o].tags[r[s]])for(var t=0;t<a.length;t++){jQuery("li."+a[t]).index()>jQuery("li."+k).index()&&"__system__"!==a[t]?e.closest(".caldera-editor-processors-panel-wrap").length&&(l=' disabled="disabled"'):l="";for(var m=jQuery('<optgroup label="'+system_values[o].type+("__system__"!==a[t]?" "+jQuery("li."+a[t]).find(".processor-line-number").html():"")+'"'+l+">"),u=0;u<system_values[o].tags[r[s]].length;u++){var v=system_values[o].tags[r[s]][u];"__system__"!==a[t]&&(v=v.replace(o,a[t])),m.append('<option value="{'+v+'}"'+(f==="{"+v+"}"?'selected="selected"':"")+l+">"+system_values[o].tags[r[s]][u]+"</option>"),i+=1}m.children().length&&m.appendTo(e)}}if(0===i){if(e.empty(),e.data("type")){e.append('<option value="">No '+e.data("type").split(",").join(" or ")+" in form</option>");var w=!0}}else e.prop("disabled",!1);e.hasClass("required")||void 0!==w||e.prepend('<option value=""></option>'),e.val(f)}}init_magic_tags(),jQuery(document).trigger("bound.fields"),jQuery(".caldera-header-save-button").prop("disabled",!1)}},jQuery(document).ready(function(a){function b(){var b=a(".layout-grid-panel"),c=0;b.each(function(b,d){var e=a(d),f=e.find(".layout-structure"),g=e.find(".row"),h=[];g.each(function(b,d){var e=a(d),f=e.children().not(".column-merge"),g=[];c+=1,f.each(function(b,d){span=a(d).attr("class").split("-"),g.push(span[2]);var e=a(d).find(".field-location");e.length&&e.each(function(d,e){a(e).val(c+":"+(b+1)).removeAttr("disabled")})}),h.push(g.join(":"))}),f.val(h.join("|"))})}function c(b,c,e){var f,g,h="fld_"+Math.round(1e7*Math.random()),i=h,j=a("#field_config_panels");b.prop("id","").prop("title",""),f=Handlebars.compile(a("#caldera_field_config_wrapper_templ").html()),g=a.extend({},{id:i,label:"",slug:""},e),g.slug="",j.append(f(g)),b.removeClass("button-small").removeClass("button").removeClass("button-primary").removeClass("ui-draggable").removeClass("layout-new-form-field").addClass("layout-form-field").attr("data-config",h).css({display:"",opacity:""}),b.find(".layout_field_name").remove(),b.find(".field-location").prop("name","config[layout_grid][fields]["+h+"]"),b.find(".settings-panel").show(),b.appendTo(c),d(),b.find(".icon-edit").trigger("click"),a("#"+h+"_lable").focus().select(),baldrickTriggers(),a(document).trigger("field.added"),e?a("#"+i+"_type").data("type",g.type).trigger("change"):a("#"+h).trigger("field.drop"),rebuild_field_binding()}function d(){a(".toggle-options").sortable({handle:".dashicons-sort"}),a("#grid-pages-panel").sortable({placeholder:"row-drop-helper",handle:".sort-handle",items:".first-row-level",axis:"y",stop:function(){b()}}),a(".layout-column").sortable({connectWith:".layout-column",appendTo:"#grid-pages-panel",helper:"clone",items:".layout-form-field",handle:".drag-handle",cursor:"move",opacity:.7,cursorAt:{left:100,top:15},start:function(a,b){b.helper.css({width:"200px",height:"35px",paddingTop:"20px"})},stop:function(a,c){c.item.removeAttr("style"),b()}}),a("h3 .layout-new-form-field").draggable({helper:"clone",appendTo:"body"}),a(".page-toggle.button").droppable({accept:".layout-form-field",over:function(b,c){a(this).trigger("click"),a(".layout-column").sortable("refresh")}}),a(".layout-column").droppable({greedy:!0,activeClass:"ui-state-dropper",hoverClass:"ui-state-hoverable",accept:".layout-new-form-field",drop:function(b,d){c(d.draggable.clone(),a(this))}}),b()}function e(){if(h){var b=a(".column-fieldinsert");b.length?(b.stop().fadeToggle(700),a(".layout-new-form-field").stop().fadeToggle(700)):cf_clear_puler()}}function f(){a(".caldera-editor-processors-panel ul").sortable({update:function(){rebuild_field_binding()}})}function g(b){var c=a(b),d=a("#"+c.val()+"-tmpl").length?a("#"+c.val()+"-tmpl").html():"",e=c.closest(".caldera-editor-processor-config-wrapper"),f=e.find(".caldera-config-processor-setup"),g=Handlebars.compile(d),h=e.find(".processor_config_string").val(),i=c.data("type");h=h.length&&i===c.val()?JSON.parse(h):processor_defaults[c.val()+"_cfg"],h||(h={}),h._id=e.prop("id"),h._name="config[processors]["+e.prop("id")+"][config]",g=a("<div>").html(g(h)),f.html(g.html()),"function"==typeof window[c.val()+"_init"]&&window[c.val()+"_init"](e.prop("id"),f),e.find(".no-conditions").length&&e.find(".toggle_option_tab").remove(),rebuild_field_binding(),baldrickTriggers(),a(".wp-baldrick").baldrick({request:ajaxurl,method:"POST",before:function(b){var c=a(b);c.data("addNode")&&!c.data("request")&&c.data("request","cf_get_default_setting")}})}add_new_grid_page=function(a){return{page_no:"pg_"+Math.round(1e7*Math.random())}},add_page_grid=function(b){var c=a(".page-toggle").length+1,e=a('<button type="button" data-name="Page '+c+'" data-page="'+b.rawData.page_no+'" class="page-toggle button">'+b.params.trigger.data("addtitle")+" "+c+"</button> "),f=a("#page-toggles");e.appendTo(f),f.show(),d(),e.trigger("click"),1===c&&f.hide(),a(document).trigger("add.page")},a(document).on("remove.page add.page load.page",function(b){var c=a(".page-toggle").length,d=a("#tab_pages");c<=1?d.hide():d.show()}),d(),a("#grid-pages-panel").on("click",".column-fieldinsert .dashicons-plus-alt",function(b){var d=a(this).closest(".column-container");c(a("#newfield-tool").clone().css("display",""),d)}),a("#grid-pages-panel").on("click",".column-split",function(b){var c=a(this).parent().parent(),e=c.attr("class").split("-"),f=a("<div>").insertAfter(c),g=Math.ceil(e[2]/2),h=Math.floor(e[2]/2);e[2]=g,c.attr("class",e.join("-")),e[2]=h,f.addClass(e.join("-")).append('<div class="layout-column column-container">'),a(this).remove(),d(),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),a("#grid-pages-panel").on("click",".column-remove",function(c){var d=a(this).closest(".row"),e=d.find(".layout-form-field"),f=d.closest(".layout-grid-panel");if(e.length){if(!confirm(a("#row-remove-fields-message").text()))return;e.each(function(b,c){var d=a(c).data("config");a("#"+d).remove(),a('option[value="'+d+'"]').remove(),a('[data-bind="'+d+'"]').remove(),delete current_form_fields[d]})}d.slideUp(200,function(){if(a(this).remove(),b(),rebuild_field_binding(),!f.find(".row").length){f.remove();var c=a("#page-toggles .button-primary"),d=c.prev(),e=c.next();c.remove(),d.length?d.trigger("click"):e.trigger("click")}a(document).trigger("remove.page")}),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),a(".caldera-config-editor-main-panel").on("click",".caldera-add-row",function(c){if(c.preventDefault(),!a(".page-active").length)return void a(".caldera-add-page").trigger("click");var e=a('<div style="display:none;" class="first-row-level row"><div class="col-xs-12"><div class="layout-column column-container"></div></div></div>');a(".page-active").append(e),e.slideDown(200),d(),b()}),a("#grid-pages-panel").on("click",".column-join",function(c){var d=a(this).parent().parent().parent(),e=d.prev(),f=e.attr("class").split("-"),g=d.attr("class").split("-");f[2]=parseFloat(f[2])+parseFloat(g[2]),d.find(".layout-column").contents().appendTo(e.find(".layout-column")),e.attr("class",f.join("-")),d.remove(),b(),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),a("#grid-pages-panel").on("mouseenter",".row",function(c){var d=jQuery(this);jQuery(".column-tools,.column-merge").remove(),d.children().children().first().append('<div class="column-remove column-tools"><i class="icon-remove"></i></div>'),d.children().children().last().append('<div class="column-sort column-tools" style="text-align:right;"><i class="dashicons dashicons-menu drag-handle sort-handle"></i></div>'),d.children().children().not(":first").prepend('<div class="column-merge"><div class="column-join column-tools"><i class="icon-join"></i></div></div>');var e=d.parent().parent().parent().width()/12-1;d.children().children().each(function(b,c){var d=a(c),e=d.width()/2-5;d.prepend('<div class="column-fieldinsert column-tools"><i class="dashicons dashicons-plus-alt"></i></div>'),d.parent().hasClass("col-xs-1")||(d.prepend('<div class="column-split column-tools"><i class="dashicons dashicons-leftright"></i></div>'),d.find(".column-split").css("left",e))}),jQuery(".column-merge").draggable({axis:"x",helper:"clone",appendTo:d,grid:[e,0],drag:function(c,d){a(this).addClass("dragging"),a(".column-tools").remove(),a(".column-split").remove();var e=a(this).parent().parent(),f=d.helper,g=d.originalPosition.left>f.position().left?"left":"right",h=e.prev(),i=Math.round(e.parent().width()/12-10),j=Math.abs(d.originalPosition.left-f.position().left);if(e.parent().addClass("sizing"),j>=i){var k=h.attr("class").split("-"),l=e.attr("class").split("-");k[2]=parseFloat(k[2]),l[2]=parseFloat(l[2]),"left"===g?(k[2]--,l[2]++,k[2]>0&&k[2]<k[2]+l[2]?(h.attr("class",k.join("-")),e.attr("class",l.join("-")),d.originalPosition.left=f.position().left):a(this).draggable("option","disabled",!0)):(k[2]++,l[2]--,l[2]>0&&l[2]<l[2]+l[2]?(h.attr("class",k.join("-")),e.attr("class",l.join("-")),d.originalPosition.left=f.position().left):a(this).draggable("option","disabled",!0)),b()}},stop:function(){a(this).removeClass("dragging").parent().parent().parent().removeClass("sizing")}})}),a("#grid-pages-panel").on("mouseleave",".row",function(a){jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),a("#grid-pages-panel").on("click",".layout-form-field .icon-remove",function(){var b=a(this),c=b.parent(),d=a("#"+c.data("config"));c.slideUp(100,function(){a(this).remove()}),d.slideUp(100,function(){a(this).remove()})}),a(document).on("click",".layout-form-field .dashicons-admin-page",function(){var b=a(this),d=b.parent(),e=d.data("config"),f=a("#"+e).formJSON(),g=b.closest(".column-container"),h=d.clone().css("display",""),i={};d.hasClass("field-edit-open")&&(d.removeClass("field-edit-open"),h.removeClass("field-edit-open"),a(".caldera-editor-field-config-wrapper").hide()),f.config.fields[e]&&(i=f.config.fields[e],delete i.ID),c(h,g,i)}),a(document).on("click",".layout-form-field .icon-edit",function(){var b=a(this),c=b.parent(),d=a("#"+c.data("config")+"_type").val();a(".caldera-editor-field-config-wrapper").hide(),c.hasClass("field-edit-open")?c.removeClass("field-edit-open"):(a(".layout-form-field").removeClass("field-edit-open"),c.addClass("field-edit-open"),a("#"+c.data("config")).show()),a(document).trigger("show."+c.data("config")),a(document).trigger("show.fieldedit"),"radio"!==d&&"checkbox"!==d&&"dropdown"!==d&&"toggle_switch"!==d||a("#"+c.data("config")+"_auto").trigger("change")}),a("body").on("click",".layout-modal-edit-closer,.layout-modal-save-action",function(b){b.preventDefault();var c=a(this),d=a(".layout-form-field.edit-open"),e=c.closest(".layout-modal-container");settings=e.find(".settings-panel").first(),a(".edit-open").removeClass("edit-open"),settings.appendTo(d.find(".settings-wrapper")).hide(),e.hide()}),a(".layout-editor-body").on("change",".layout-core-pod-query",function(){a(this).parent().find(".settings-panel-row").remove(),a(".edit-open").find(".drag-handle .set-pod").html(" - "+a(this).val())}),a(".layout-editor-body").on("click",".remove-where",function(){a(this).closest(".settings-panel-row").remove()}),a(".layout-editor-body").on("click",".use-pod-container",function(){var b=a(this),c=b.prev(),d=c.val();if(d.length){a(".edit-open").find(".drag-handle .set-pod").html(" - "+c.val()),b.parent().parent().find(".spinner").css("display","inline-block");var e={action:"pq_loadpod",pod_reference:{pod:d}};a.post(ajaxurl,e,function(c){b.parent().find(".spinner").css("display","none");var d=a("#where-line-tmpl").html(),e="",f=b.closest(".settings-panel").data("container");for(var g in c)e+='<option value="'+c[g]+'">'+c[g]+"</option>";d=d.replace(/{{fields}}/g,e).replace(/{{container_id}}/g,f),b.parent().append(d)})}}),a(".caldera-editor-header").on("click",".column-sort .icon-edit",function(a){}),a(".layout-editor-body").on("tray_loaded",".layout-template-tray",function(){d()}),a(".caldera-editor-header").on("click",".caldera-editor-header-nav a",function(b){b.preventDefault();var c=a(this);a(".caldera-editor-header-nav li").removeClass("active"),a(".caldera-editor-body").hide(),a(c.attr("href")).show(),c.parent().addClass("active"),rebind_field_bindings()}),a("body").on("change",".required",function(){check_required_bindings(this)}),a("body").on("submit",".caldera-forms-options-form",function(b){a(".required.has-error").length&&b.preventDefault()}),a(".caldera-editor-body").on("click",".add-toggle-option",function(b){var c=a(this);if(c.data("bulk"))return a(c.data("bulk")).toggle(),void a(c.data("bulk")).find("textarea").focus();var d=c.closest(".caldera-editor-field-config-wrapper"),e=d.find(".toggle-options"),f=a("#field-option-row-tmpl").html(),g=Handlebars.compile(f),h="opt"+parseInt(1048576*(Math.random()+1)),i={_name:"config[fields]["+d.prop("id")+"][config]",option:{}};if(c.data("options")){for(var j=a(c.data("options")),k=j.val().split("\n"),l=!1,m=0;m<k.length;m++){var n=k[m],o=n,p=o.split("|");p.length>1&&(o=p[0],n=p[1],l=!0),i.option["opt"+parseInt(1048576*(Math.random()+m))]={value:o,label:n,default:!1}}a(c.data("options")).parent().hide(),j.val(""),!0===l?d.find(".toggle_show_values").prop("checked",!0):d.find(".toggle_show_values").prop("checked",!1),e.empty()}else i.option[h]={value:"",label:"",default:!1};a(".preset_options").val(""),e.append(g(i)),d.find(".toggle_show_values").trigger("change"),a(".toggle-options").sortable({handle:".dashicons-sort"}),k||e.find(".toggle_label_field").last().focus()}),a(".caldera-editor-body").on("change",".preset_options",function(b){var c=a(this),d=c.val(),e=a(c.data("bulk"));preset_options&&preset_options[d]&&preset_options[d].data&&("object"==typeof preset_options[d].data&&preset_options[d].data.length&&(preset_options[d].data=preset_options[d].data.join("\n")),e.val(preset_options[d].data))}),a(".caldera-editor-body").on("click",".toggle-remove-option",function(b){var c=a(this).closest(".caldera-editor-field-config-wrapper").find(".field-config").first();a(this).parent().remove(),c.trigger("change"),a(document).trigger("option.remove")}),a(".caldera-editor-body").on("click",".page-toggle",function(b){var c=a(this),d=c.parent(),e=d.find(".button");e.removeClass("button-primary"),a(".layout-grid-panel").hide().removeClass("page-active"),a("#"+c.data("page")).show().addClass("page-active"),c.addClass("button-primary"),e.each(function(b,c){a(c).html(d.data("title")+" "+(b+1))}),1===e.length&&d.hide()}),a(".caldera-editor-body").on("blur toggle.values",".toggle_label_field",function(b){var c=a(this),d=c.prev();d.val().length||d.val(c.val())}),a(document).on("change focusout",".toggle_value_field",function(){a(document).trigger("show.fieldedit")}),a(document).on("show.fieldedit option.remove",function(b){a(".toggle_value_field.has-error").removeClass("has-error");for(var c=a("#"+a(".layout-form-field.field-edit-open").data("config")),d=c.find(".toggle_value_field"),e=c.find(".notice"),f=0,g=0;g<d.length;g++){for(var h=(d[g].value,0),i=0;i<d.length;i++)d[g]!==d[i]&&d[g].value===d[i].value&&(a(d[i]).addClass("has-error"),h++);h>0&&(a(d[g]).addClass("has-error"),f++)}f>0?(e.slideDown(),b.preventDefault()):e.slideUp()});var h=!1;focus_initial_field=function(b){var c=a(".layout-grid-panel .icon-edit").first();c.length?c.trigger("click"):(a(".layout-column.column-container").first().trigger("mouseover"),h=setInterval(e,500)),a(document).off("load.page",focus_initial_field)},a(document).on("load.page",focus_initial_field),cf_clear_puler=function(){h&&(clearTimeout(h),a(document).off("mouseover",".layout-new-form-field, .column-fieldinsert",cf_clear_puler)),a(".layout-new-form-field, .column-fieldinsert").fadeIn()},a(document).on("mouseover",".layout-new-form-field, .column-fieldinsert",cf_clear_puler),rebuild_field_binding(),a(document).trigger("load.page"),a("body").on("click",".caldera-processor-nav a",function(b){b.preventDefault();var c=a(this);a(".caldera-processor-nav").removeClass("active"),a(".caldera-editor-processor-config-wrapper").hide(),a(c.attr("href")).show(),c.parent().addClass("active")}),a("body").on("click",".add-new-processor",function(b){var c=a(this),d=Handlebars.compile(a("#processor-wrapper-tmpl").html());wrap=a(".active-processors-list"),process_conf=a(".caldera-editor-processor-config"),processid=Math.round(1e8*Math.random()),new_templ=Handlebars.compile(a("#processor-line-tmpl").html()),new_proc={id:"fp_"+processid,type:c.data("type")},wrap.append(new_templ(new_proc)),process_conf.append(d(new_proc)),a("#form_processor_baldrickModalCloser").trigger("click"),a(".caldera-processor-nav a").last().trigger("click"),a("#fp_"+processid+"_type").val(c.data("type")).trigger("change"),f(),baldrickTriggers()}),a("body").on("click",".delete-processor",function(b){var c=a(this),d=c.closest(".caldera-editor-processor-config-wrapper");d.data("type"),confirm(c.data("confirm"))&&(a("."+d.prop("id")).remove(),d.remove(),a(".caldera-processor-nav a").first().trigger("click"),rebuild_field_binding())}),a("body").on("change",".caldera-select-processor-type",function(b){var c=a(this),d=c.closest(".caldera-editor-processor-config-wrapper"),e=c.find('option[value="'+c.val()+'"]').text(),f=d.find(".caldera-editor-processor-title"),h=a(".caldera-processor-nav.active a");""===e&&(e=f.data("title")),f.html(e),h.html(e+' <span class="processor-line-number"></span>').parent().addClass("processor_type_"+c.val()),g(this),rebuild_field_binding()}),a(document).on("click","#cf-shortcode-preview",function(){a(this).focus().select()}),a(document).on("change",".cf-email-preview-toggle",function(){var b=a(this),c=a(".caldera-header-email-preview-button");b.is(":checked")?c.show().attr("aria-hidden","false").css("visibility","visible"):c.hide().attr("aria-hidden","true").css("visibility","hidden")}),rebuild_field_binding(),a(".caldera-select-processor-type").each(function(a,b){g(b)}),f()}),Handlebars.registerHelper("_field",function(a){var b=this,c="",d="",e="",f=this[a.hash.slug]?' data-default="'+this[a.hash.slug]+'"':"";a.hash.required&&(c=" required"),a.hash.exclude&&(e='data-exclude="'+a.hash.exclude+'"'),a.hash.array&&(d="[]","true"!==a.hash.array&&(f='value="'+a.hash.array+'"')),out="<select "+(a.hash.type?'data-type="'+a.hash.type+'"':"")+f+" "+e+' name="'+this._name+"["+a.hash.slug+"]"+d+'" id="'+this._id+"_"+a.hash.slug+'" class="block-input field-config caldera-field-bind'+c+'">',this[a.hash.slug]?out+='<option class="bound-field" value="'+this[a.hash.slug]+'" class="bound-field"></option>':a.hash.required||(out+='<option value=""></option>');for(var g in current_form_fields){var h="";a.hash.type&&current_form_fields[g].type!==a.hash.type||(b[a.hash.slug]&&b[a.hash.slug]===g&&(h=' selected="selected"'),out+='<option value="'+g+'"'+h+">"+current_form_fields[g].label+" ["+current_form_fields[g].slug+"]</option>")}return out+="</select>",a.hash.required&&(out+='<input class="field-config" name="'+this._name+'[_required_bounds][]" type="hidden" value="'+a.hash.slug+'">'),out}),Handlebars.registerHelper("console",function(a,b){console.log(this)});
function CFState(a,b){function c(a){return m.hasOwnProperty(a)}function d(a){var c=b("#"+a);return c.length?(c.on("change keyup",function(){var a=b(this);console.log(c.attr("type")),console.log(a.attr("type")),n[a.attr("id")]=f(a),j.mutateState([a.attr("id")],a.val())}),n[a]=f(b(document.getElementById(a))),j.mutateState([c.attr("id")],c.val()),!0):(c=b("."+a),c.length?(c.on("change",function(){var a,c,d=[],e=b(this),h=e.attr("type");switch(h){case"radio":a=e.data("radio-field"),c=b("[data-radio-field="+a+"]"),d="";break;case"checkbox":a=e.data("checkbox-field"),c=b("[data-checkbox-field="+a+"]");break;default:a=e.data("field"),c=b("[data-field="+a+"]")}if(c.length)if(1==c.length)d=f(b(c[0]));else if("checkbox"===h){var i,k=0;c.each(function(a,c){i=b(c),i.prop("checked")&&(k+=g(f(i))),d.push(i.val())}),n[a]=k}else c.each(function(c,e){var g=b(e);g.prop("checked")&&("radio"===h?(n[a]=f(g),d=g.val()):d.push(g.val()))});else d=0;j.mutateState(a,d)}),!0):(j.unbind(a),!1))}function e(a,b){m[a]=0,n[a]=0,j.events().subscribe(a,function(a,b){n[b]=a})}function f(a){if(a.is("select")&&a.has("option")&&(a=a.find(":selected")),!a.length)return 0;if(a.is("hidden"))return a.val();var b=0,c=a.attr("data-calc-value");return b=void 0===c||!1===c||isNaN(c)?a.val():a.data("calc-value"),g(b)}function g(a){return!a||isNaN(a)?0:window.parseFloat(a)}function h(a){return"number"==typeof a}function i(a){return"string"==typeof a}var j=this,k=new CFEvents(this),l={},m={},n={};this.init=function(a,b){for(var c in a)"object"==typeof b[c]?"calculation"==b[c].type&&e(c,b[c]):d(c)?(m[c]=a[c],b.hasOwnProperty(c)?n[c]=b[c]:n[c]=null):(m[c]="",l[c]=!0,n[c]=null)},this.getState=function(a){return!!c(a)&&m[a]},this.getCalcValue=function(a,d){var e=0;if(!c(a))return e;if(d){d=0;var k,l=d;return b("#"+a).each(function(){l=0,k=b(this),k.prop("checked")&&(l=f(k),g(l)>g(d)&&(d=g(l)))}),g(d)}if(n.hasOwnProperty(a)){if(!1===n[a]||null===n[a]){var m=f(b(document.getElementById(a)));i(m)&&(m=g(m)),h(m)&&(n[a]=m)}e=n[a]}else e=j.getState(a),b.isArray(e)&&(e=e.reduce(function(a,b){return g(a)+g(b)},0)),h(e)&&(n[a]=e);return g(e)},this.mutateState=function(a,b){return!!c(a)&&(m[a]!=b&&(m[a]=b,k.trigger(a,b)),!0)},this.unbind=function(a){j.mutateState(a,""),l[a]=!0,delete n[a]},this.rebind=function(a){d(a),delete l[a]},this.events=function(){return{subscribe:function(a,b){c(a)&&k.subscribe(a,b)},detach:function(a,b){k.detach(a,b)}}}}
function CalderaFormsFieldSync(a,b,c,d){for(var e=0;e<b.length;e++)d(document).on("keyup change blur mouseover","[data-field='"+b[e]+"']",function(){var b=a.data("sync");if(id=a.data("field"),reg=new RegExp("{{([^}]*?)}}","g"),template=b.match(reg),!a.data("unsync")&&void 0!=template&&template.length){for(var e=0;e<template.length;e++){for(var f=template[e].replace(/\}/g,"").replace(/\{/g,""),g=new RegExp(template[e],"g"),h=c.find("[data-field='"+f+"']"),i="",j=0;j<h.length;j++){var k=d(h[j]);(!k.is(":radio")&&!k.is(":checkbox")||k.is(":checked"))&&(i+=k.val())}b=b.replace(g,i)}a.val(b)}}),d("[data-field='"+b[e]+"']").trigger("change")}function CalderaFormsResetNonce(a,b,c){function d(a){return(new Date).getTime()-36e3>a}function e(){c.ajax({url:b.rest.tokens.nonce,method:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",b.rest.nonce)},data:{form_id:a}}).success(function(a){f.val(a.nonce),f.data("nonce-time",(new Date).getTime())})}var f;this.init=function(){f=c("#"+b.nonce.field+"_"+a),d(f.data("nonce-time"))&&e()}}var cf_jsfields_init,cf_presubmit;!function(a){cf_validate_form=function(a){return a.parsley({errorsWrapper:'<span class="help-block caldera_ajax_error_block"></span>',errorTemplate:"<span></span>",errorsContainer:function(a){return a.$element.closest(".form-group")}}).on("field:error",function(a){if("number"==this.$element.attr("type")&&0==this.$element.attr("min")){var b=this.$element.val();return void(0<=b&&(void 0==this.$element.attr("max")||b<=this.$element.attr("max"))&&(a.validationResult=!0))}this.$element.closest(".form-group").addClass("has-error")}).on("field:success",function(){this.$element.closest(".form-group").removeClass("has-error")})},a("[data-sync]").each(function(){var b=a(this);new CalderaFormsFieldSync(b,b.data("binds"),b.closest("form"),a)}),a(document).on("change keypress","[data-sync]",function(){a(this).data("unsync",!0)}),cf_jsfields_init=function(){a(".init_field_type[data-type]").each(function(b,c){var d=a(c);"function"==typeof window[d.data("type")+"_init"]&&window[d.data("type")+"_init"](d.prop("id"),d[0])}),window.Parsley.on("field:validated",function(){setTimeout(function(){a(document).trigger("cf.error")},15)}),"undefined"==typeof resBaldrickTriggers&&a(".caldera_forms_form").length,a(document).trigger("cf.fieldsInit")},a("document").ready(function(){cf_jsfields_init()}),a(".caldera-form-page").length&&a(".caldera-form-page").on("keypress","[data-field]:not(textarea)",function(a){13===a.keyCode&&a.preventDefault()}),a(document).on("click",".cf_modal_button",function(b){b.preventDefault();var c=a(this);a(c.attr("href")).show()}),a(document).on("click",".caldera-front-modal-closer",function(b){b.preventDefault(),a(this).closest(".caldera-front-modal-container").hide()}),a(document).on("cf.add cf.enable cf.disable cf.pagenav",cf_jsfields_init),a(document).on("click","[data-page]",function(b){var c,d,e,f=a(this),g=f.closest(".caldera-form-page"),h=f.closest("form.caldera_forms_form"),i=h.data("instance"),j=h.find(".caldera-form-page:visible").data("formpage"),k=g.data("formpage")?g.data("formpage"):f.data("page"),l=a('.breadcrumb[data-form="caldera_form_'+i+'"]'),m=!0,n={};if(h.length){if(cf_validate_form(h).destroy(),e=h.find("[data-field]"),h.find(".has-error").removeClass("has-error"),"prev"!==f.data("page")&&k>=j)for(var o=0;o<e.length;o++){var p=a(e[o]);if(p.is(":radio,:checkbox")){if(!p.hasClass("option-required")||!1===p.is(":visible"))continue;n[p.data("field")]||(n[p.data("field")]=[]),n[p.data("field")].push(p.prop("checked"))}else{if(p.prop("required")&&!1===p.is(":visible"))continue;if(p.prop("required")&&!0!==p.parsley().isValid()){if(p.is(":visible"))p.parsley().validate(),b.preventDefault();else{var q=parseFloat(p.closest(".caldera-form-page[data-formpage]").data("formpage"));q<parseFloat(k)&&h.find('[data-page="'+q+'"]').addClass("has-error")}m=!1}}}for(var r in n)n[r].indexOf(!0)<0?(a('[for="'+r+"_"+i+'"]').parent().addClass("has-error"),m=!1):a('[for="'+r+"_"+i+'"]').parent().removeClass("has-error");if(!1===m)return cf_validate_form(h).validate(),!1;"next"===f.data("page")?(l&&l.find("li.active").removeClass("active").children().attr("aria-expanded","false"),c=h.find('.caldera-form-page[data-formpage="'+(k+1)+'"]'),c.length&&(g.hide().attr("aria-hidden","true").css("visibility","hidden"),c.show().attr("aria-hidden","false").css("visibility","visible"),l&&l.find('a[data-page="'+(k+1)+'"]').attr("aria-expanded","true").parent().addClass("active"))):"prev"===f.data("page")?(l&&l.find("li.active").removeClass("active").children().attr("aria-expanded","false"),d=h.find('.caldera-form-page[data-formpage="'+(k-1)+'"]'),d.length&&(g.hide().attr("aria-hidden","true").css("visibility","hidden"),d.show().attr("aria-hidden","false").css("visibility","visible"),l&&l.find('a[data-page="'+(k-1)+'"]').attr("aria-expanded","true").parent().addClass("active"))):f.data("pagenav")&&(b.preventDefault(),f.closest(".breadcrumb").find("li.active").removeClass("active").children().attr("aria-expanded","false"),a("#"+f.data("pagenav")+" .caldera-form-page").hide().attr("aria-hidden","true").css("visibility","hidden"),a("#"+f.data("pagenav")+'\t.caldera-form-page[data-formpage="'+f.data("page")+'"]').show().attr("aria-hidden","false").css("visibility","visible"),f.parent().addClass("active").children().attr("aria-expanded","true")),a("html, body").animate({scrollTop:h.offset().top-100},200),a(document).trigger("cf.pagenav")}});var b;a(".caldera-grid .breadcrumb").each(function(c,d){a(d).find("a[data-pagenav]").each(function(c,d){var e=a(d),f=e.data("pagenav");a("#"+f+' .caldera-form-page[data-formpage="'+e.data("page")+'"]').find(".has-error").length&&(e.parent().addClass("error"),void 0===b&&(e.trigger("click"),b=!0))})}),a(document).on("click",'form.caldera_forms_form [type="submit"]',function(b){var c=a(this),d=c.closest(".caldera_forms_form"),e=cf_validate_form(d);e.validate()?e.destroy():b.preventDefault()})}(jQuery),window.addEventListener("load",function(){!function(a){"use strict";if("object"==typeof CF_API_DATA){var b,c={};a(".caldera_forms_form").each(function(d,e){b=a(e).data("form-id"),c[b]=new CalderaFormsResetNonce(b,CF_API_DATA,a),c[b].init()})}if("object"==typeof CFFIELD_CONFIG){var d,e,f,g,h;a(".caldera_forms_form").each(function(b,c){h=a(c),d=h.attr("id"),g=h.data("instance"),"object"==typeof CFFIELD_CONFIG[g]&&(f=CFFIELD_CONFIG[g],e=new Caldera_Forms_Field_Config(f,a(document.getElementById(d)),a),e.init())})}}(jQuery)});
function size_format(a){var b=!1;return quant=[{unit:"TB",mag:1099511627776},{unit:"GB",mag:1073741824},{unit:"MB",mag:1048576},{unit:"kB",mag:1024},{unit:"B ",mag:1}],quant.forEach(function(c){parseFloat(a)>=c.mag&&0==b&&(b=a/c.mag,b=a>1048576?b.toFixed(2):Math.round(b),b=b+" "+c.unit)}),b}function handleFileSelect(a,b){if(a.stopPropagation(),a.preventDefault(),a.dataTransfer)var c=a.dataTransfer.files;else var c=a.target.files;for(var d=[],e="valid",f=0;f<c.length;f++){var g="fl"+Math.round(0xaa7fca0bf1f1*Math.random()),h=1,i="";b.allowed.length&&b.allowed.indexOf(c[f].type)<0&&(h=0,i=b.notices.invalid_filetype),b.max_size&&c[f].size>b.max_size&&(h=0,i=b.notices.file_exceeds_size_limit),c[f].size||(h=0,i=b.notices.zero_byte_file),cf_uploader_filelist[a.target.id+"_file_"+g]={file:c[f],state:h,field:b.id,message:i}}for(var f in cf_uploader_filelist)if(cf_uploader_filelist[f].field===b.id){var j="";0===cf_uploader_filelist[f].state&&(j="has-error"),d.push('<li class="cf-uploader-queue-item '+f+" "+j+'">','<a href="#remove-file" data-file="'+f+'" class="cf-file-remove">&times;</a> <span class="file-name">',cf_uploader_filelist[f].file.name,"</span>&nbsp;",'<div class="progress-bar" style="background:#ececec;"><div class="bar" id="progress-file-'+f+'" style="height:2px;width:0%;background:#a3be5f;"></div></div>','<small class="file-type">',cf_uploader_filelist[f].file.type||"n/a","</small> ",'<small class="file-size">'+size_format(cf_uploader_filelist[f].file.size)+"</small>",'<small class="file-error">'+cf_uploader_filelist[f].message+"</small>","</li>"),cf_uploader_filelist[f].message.length&&(e=cf_uploader_filelist[f].message)}a.target.value=null,document.getElementById(a.target.id+"_file_list").innerHTML='<ul class="cf-adv-preview-list">'+d.join("")+"</ul>",jQuery("#"+a.target.id+"_validator").val(e)}function handleDragOver(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}function handleDragOver(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}var cf_uploader_filelist={};jQuery(function(a){a(document).on("click",".cf-uploader-trigger",function(){var b=a(this);a("#"+b.data("parent")).trigger("click")}),a(".cf-multi-uploader").hide(),a(document).on("click",".cf-file-remove",function(b){b.preventDefault();var c=a(this),d=c.closest(".cf-adv-preview-list"),e=c.closest(".cf-multi-uploader-list").data("field"),f=c.closest(".cf-multi-uploader-list").data("id"),g=a("#"+f+"_validator");g.val(""),a('[data-parent="'+e+'"]').show(),delete cf_uploader_filelist[c.data("file")],c.closest(".cf-multi-uploader-list").parent().find(".cf-uploader-trigger").show(),c.parent().remove(),d.children().length||d.remove();for(var h in cf_uploader_filelist)cf_uploader_filelist[h].field===f&&cf_uploader_filelist[h].message.length&&g.val(cf_uploader_filelist[h].message)}),a(document).on("change",".cf-multi-uploader",function(b){var c=a(this),d=c.data("config");d.id=c.prop("id"),c.prop("multiple")||("object"!=typeof cf_uploader_filelist&&(cf_uploader_filelist={}),c.parent().find(".cf-uploader-trigger").hide()),handleFileSelect(b,d)}),window.Parsley.addValidator("fileType",{requirementType:"string",validateString:function(a,b){return"valid"===a}})});